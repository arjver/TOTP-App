(function(){const ee=document.createElement("link").relList;if(ee&&ee.supports&&ee.supports("modulepreload"))return;for(const ie of document.querySelectorAll('link[rel="modulepreload"]'))re(ie);new MutationObserver(ie=>{for(const oe of ie)if(oe.type==="childList")for(const se of oe.addedNodes)se.tagName==="LINK"&&se.rel==="modulepreload"&&re(se)}).observe(document,{childList:!0,subtree:!0});function te(ie){const oe={};return ie.integrity&&(oe.integrity=ie.integrity),ie.referrerpolicy&&(oe.referrerPolicy=ie.referrerpolicy),ie.crossorigin==="use-credentials"?oe.credentials="include":ie.crossorigin==="anonymous"?oe.credentials="omit":oe.credentials="same-origin",oe}function re(ie){if(ie.ep)return;ie.ep=!0;const oe=te(ie);fetch(ie.href,oe)}})();const app="";function noop(){}function is_promise(ne){return ne&&typeof ne=="object"&&typeof ne.then=="function"}function run(ne){return ne()}function blank_object(){return Object.create(null)}function run_all(ne){ne.forEach(run)}function is_function(ne){return typeof ne=="function"}function safe_not_equal(ne,ee){return ne!=ne?ee==ee:ne!==ee||ne&&typeof ne=="object"||typeof ne=="function"}let src_url_equal_anchor;function src_url_equal(ne,ee){return src_url_equal_anchor||(src_url_equal_anchor=document.createElement("a")),src_url_equal_anchor.href=ee,ne===src_url_equal_anchor.href}function is_empty(ne){return Object.keys(ne).length===0}function subscribe(ne,...ee){if(ne==null)return noop;const te=ne.subscribe(...ee);return te.unsubscribe?()=>te.unsubscribe():te}function component_subscribe(ne,ee,te){ne.$$.on_destroy.push(subscribe(ee,te))}function null_to_empty(ne){return ne==null?"":ne}function set_store_value(ne,ee,te){return ne.set(te),ee}function append(ne,ee){ne.appendChild(ee)}function insert(ne,ee,te){ne.insertBefore(ee,te||null)}function detach(ne){ne.parentNode.removeChild(ne)}function destroy_each(ne,ee){for(let te=0;te<ne.length;te+=1)ne[te]&&ne[te].d(ee)}function element(ne){return document.createElement(ne)}function text(ne){return document.createTextNode(ne)}function space(){return text(" ")}function empty(){return text("")}function listen(ne,ee,te,re){return ne.addEventListener(ee,te,re),()=>ne.removeEventListener(ee,te,re)}function attr(ne,ee,te){te==null?ne.removeAttribute(ee):ne.getAttribute(ee)!==te&&ne.setAttribute(ee,te)}function children(ne){return Array.from(ne.childNodes)}function set_data(ne,ee){ee=""+ee,ne.wholeText!==ee&&(ne.data=ee)}function set_style(ne,ee,te,re){te===null?ne.style.removeProperty(ee):ne.style.setProperty(ee,te,re?"important":"")}let current_component;function set_current_component(ne){current_component=ne}function get_current_component(){if(!current_component)throw new Error("Function called outside component initialization");return current_component}function onMount(ne){get_current_component().$$.on_mount.push(ne)}const dirty_components=[],binding_callbacks=[],render_callbacks=[],flush_callbacks=[],resolved_promise=Promise.resolve();let update_scheduled=!1;function schedule_update(){update_scheduled||(update_scheduled=!0,resolved_promise.then(flush))}function add_render_callback(ne){render_callbacks.push(ne)}function add_flush_callback(ne){flush_callbacks.push(ne)}const seen_callbacks=new Set;let flushidx=0;function flush(){const ne=current_component;do{for(;flushidx<dirty_components.length;){const ee=dirty_components[flushidx];flushidx++,set_current_component(ee),update(ee.$$)}for(set_current_component(null),dirty_components.length=0,flushidx=0;binding_callbacks.length;)binding_callbacks.pop()();for(let ee=0;ee<render_callbacks.length;ee+=1){const te=render_callbacks[ee];seen_callbacks.has(te)||(seen_callbacks.add(te),te())}render_callbacks.length=0}while(dirty_components.length);for(;flush_callbacks.length;)flush_callbacks.pop()();update_scheduled=!1,seen_callbacks.clear(),set_current_component(ne)}function update(ne){if(ne.fragment!==null){ne.update(),run_all(ne.before_update);const ee=ne.dirty;ne.dirty=[-1],ne.fragment&&ne.fragment.p(ne.ctx,ee),ne.after_update.forEach(add_render_callback)}}const outroing=new Set;let outros;function group_outros(){outros={r:0,c:[],p:outros}}function check_outros(){outros.r||run_all(outros.c),outros=outros.p}function transition_in(ne,ee){ne&&ne.i&&(outroing.delete(ne),ne.i(ee))}function transition_out(ne,ee,te,re){if(ne&&ne.o){if(outroing.has(ne))return;outroing.add(ne),outros.c.push(()=>{outroing.delete(ne),re&&(te&&ne.d(1),re())}),ne.o(ee)}else re&&re()}function handle_promise(ne,ee){const te=ee.token={};function re(ie,oe,se,ae){if(ee.token!==te)return;ee.resolved=ae;let ce=ee.ctx;se!==void 0&&(ce=ce.slice(),ce[se]=ae);const ue=ie&&(ee.current=ie)(ce);let fe=!1;ee.block&&(ee.blocks?ee.blocks.forEach((he,le)=>{le!==oe&&he&&(group_outros(),transition_out(he,1,1,()=>{ee.blocks[le]===he&&(ee.blocks[le]=null)}),check_outros())}):ee.block.d(1),ue.c(),transition_in(ue,1),ue.m(ee.mount(),ee.anchor),fe=!0),ee.block=ue,ee.blocks&&(ee.blocks[oe]=ue),fe&&flush()}if(is_promise(ne)){const ie=get_current_component();if(ne.then(oe=>{set_current_component(ie),re(ee.then,1,ee.value,oe),set_current_component(null)},oe=>{if(set_current_component(ie),re(ee.catch,2,ee.error,oe),set_current_component(null),!ee.hasCatch)throw oe}),ee.current!==ee.pending)return re(ee.pending,0),!0}else{if(ee.current!==ee.then)return re(ee.then,1,ee.value,ne),!0;ee.resolved=ne}}function update_await_block_branch(ne,ee,te){const re=ee.slice(),{resolved:ie}=ne;ne.current===ne.then&&(re[ne.value]=ie),ne.current===ne.catch&&(re[ne.error]=ie),ne.block.p(re,te)}function bind(ne,ee,te){const re=ne.$$.props[ee];re!==void 0&&(ne.$$.bound[re]=te,te(ne.$$.ctx[re]))}function create_component(ne){ne&&ne.c()}function mount_component(ne,ee,te,re){const{fragment:ie,on_mount:oe,on_destroy:se,after_update:ae}=ne.$$;ie&&ie.m(ee,te),re||add_render_callback(()=>{const ce=oe.map(run).filter(is_function);se?se.push(...ce):run_all(ce),ne.$$.on_mount=[]}),ae.forEach(add_render_callback)}function destroy_component(ne,ee){const te=ne.$$;te.fragment!==null&&(run_all(te.on_destroy),te.fragment&&te.fragment.d(ee),te.on_destroy=te.fragment=null,te.ctx=[])}function make_dirty(ne,ee){ne.$$.dirty[0]===-1&&(dirty_components.push(ne),schedule_update(),ne.$$.dirty.fill(0)),ne.$$.dirty[ee/31|0]|=1<<ee%31}function init$1(ne,ee,te,re,ie,oe,se,ae=[-1]){const ce=current_component;set_current_component(ne);const ue=ne.$$={fragment:null,ctx:null,props:oe,update:noop,not_equal:ie,bound:blank_object(),on_mount:[],on_destroy:[],on_disconnect:[],before_update:[],after_update:[],context:new Map(ee.context||(ce?ce.$$.context:[])),callbacks:blank_object(),dirty:ae,skip_bound:!1,root:ee.target||ce.$$.root};se&&se(ue.root);let fe=!1;if(ue.ctx=te?te(ne,ee.props||{},(he,le,...de)=>{const pe=de.length?de[0]:le;return ue.ctx&&ie(ue.ctx[he],ue.ctx[he]=pe)&&(!ue.skip_bound&&ue.bound[he]&&ue.bound[he](pe),fe&&make_dirty(ne,he)),le}):[],ue.update(),fe=!0,run_all(ue.before_update),ue.fragment=re?re(ue.ctx):!1,ee.target){if(ee.hydrate){const he=children(ee.target);ue.fragment&&ue.fragment.l(he),he.forEach(detach)}else ue.fragment&&ue.fragment.c();ee.intro&&transition_in(ne.$$.fragment),mount_component(ne,ee.target,ee.anchor,ee.customElement),flush()}set_current_component(ce)}class SvelteComponent{$destroy(){destroy_component(this,1),this.$destroy=noop}$on(ee,te){const re=this.$$.callbacks[ee]||(this.$$.callbacks[ee]=[]);return re.push(te),()=>{const ie=re.indexOf(te);ie!==-1&&re.splice(ie,1)}}$set(ee){this.$$set&&!is_empty(ee)&&(this.$$.skip_bound=!0,this.$$set(ee),this.$$.skip_bound=!1)}}/*! otpauth v8.0.3 | (c) Héctor Molinero Fernández <hector@molinero.dev> | MIT | https://github.com/hectorm/otpauth *//*! jssha v3.2.0 | (c) Brian Turek <brian.turek@gmail.com> | BSD-3-Clause | https://github.com/Caligatio/jsSHA */const uintToBuf=ne=>{const ee=new ArrayBuffer(8),te=new Uint8Array(ee);let re=ne;for(let ie=7;ie>=0&&re!==0;ie--)te[ie]=re&255,re-=te[ie],re/=256;return ee},t="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/";function n(ne,ee,te,re){let ie,oe,se;const ae=ee||[0],ce=(te=te||0)>>>3,ue=re===-1?3:0;for(ie=0;ie<ne.length;ie+=1)se=ie+ce,oe=se>>>2,ae.length<=oe&&ae.push(0),ae[oe]|=ne[ie]<<8*(ue+re*(se%4));return{value:ae,binLen:8*ne.length+te}}function e$1(ne,ee,te){switch(ee){case"UTF8":case"UTF16BE":case"UTF16LE":break;default:throw new Error("encoding must be UTF8, UTF16BE, or UTF16LE")}switch(ne){case"HEX":return function(re,ie,oe){return function(se,ae,ce,ue){let fe,he,le,de;if(se.length%2!=0)throw new Error("String of HEX type must be in byte increments");const pe=ae||[0],me=(ce=ce||0)>>>3,ge=ue===-1?3:0;for(fe=0;fe<se.length;fe+=2){if(he=parseInt(se.substr(fe,2),16),isNaN(he))throw new Error("String of HEX type contains invalid characters");for(de=(fe>>>1)+me,le=de>>>2;pe.length<=le;)pe.push(0);pe[le]|=he<<8*(ge+ue*(de%4))}return{value:pe,binLen:4*se.length+ce}}(re,ie,oe,te)};case"TEXT":return function(re,ie,oe){return function(se,ae,ce,ue,fe){let he,le,de,pe,me,ge,we,ve,_e=0;const ye=ce||[0],Be=(ue=ue||0)>>>3;if(ae==="UTF8")for(we=fe===-1?3:0,de=0;de<se.length;de+=1)for(he=se.charCodeAt(de),le=[],128>he?le.push(he):2048>he?(le.push(192|he>>>6),le.push(128|63&he)):55296>he||57344<=he?le.push(224|he>>>12,128|he>>>6&63,128|63&he):(de+=1,he=65536+((1023&he)<<10|1023&se.charCodeAt(de)),le.push(240|he>>>18,128|he>>>12&63,128|he>>>6&63,128|63&he)),pe=0;pe<le.length;pe+=1){for(ge=_e+Be,me=ge>>>2;ye.length<=me;)ye.push(0);ye[me]|=le[pe]<<8*(we+fe*(ge%4)),_e+=1}else for(we=fe===-1?2:0,ve=ae==="UTF16LE"&&fe!==1||ae!=="UTF16LE"&&fe===1,de=0;de<se.length;de+=1){for(he=se.charCodeAt(de),ve===!0&&(pe=255&he,he=pe<<8|he>>>8),ge=_e+Be,me=ge>>>2;ye.length<=me;)ye.push(0);ye[me]|=he<<8*(we+fe*(ge%4)),_e+=2}return{value:ye,binLen:8*_e+ue}}(re,ee,ie,oe,te)};case"B64":return function(re,ie,oe){return function(se,ae,ce,ue){let fe,he,le,de,pe,me,ge,we=0;const ve=ae||[0],_e=(ce=ce||0)>>>3,ye=ue===-1?3:0,Be=se.indexOf("=");if(se.search(/^[a-zA-Z0-9=+/]+$/)===-1)throw new Error("Invalid character in base-64 string");if(se=se.replace(/=/g,""),Be!==-1&&Be<se.length)throw new Error("Invalid '=' found in base-64 string");for(he=0;he<se.length;he+=4){for(pe=se.substr(he,4),de=0,le=0;le<pe.length;le+=1)fe=t.indexOf(pe.charAt(le)),de|=fe<<18-6*le;for(le=0;le<pe.length-1;le+=1){for(ge=we+_e,me=ge>>>2;ve.length<=me;)ve.push(0);ve[me]|=(de>>>16-8*le&255)<<8*(ye+ue*(ge%4)),we+=1}}return{value:ve,binLen:8*we+ce}}(re,ie,oe,te)};case"BYTES":return function(re,ie,oe){return function(se,ae,ce,ue){let fe,he,le,de;const pe=ae||[0],me=(ce=ce||0)>>>3,ge=ue===-1?3:0;for(he=0;he<se.length;he+=1)fe=se.charCodeAt(he),de=he+me,le=de>>>2,pe.length<=le&&pe.push(0),pe[le]|=fe<<8*(ge+ue*(de%4));return{value:pe,binLen:8*se.length+ce}}(re,ie,oe,te)};case"ARRAYBUFFER":try{new ArrayBuffer(0)}catch{throw new Error("ARRAYBUFFER not supported by this environment")}return function(re,ie,oe){return function(se,ae,ce,ue){return n(new Uint8Array(se),ae,ce,ue)}(re,ie,oe,te)};case"UINT8ARRAY":try{new Uint8Array(0)}catch{throw new Error("UINT8ARRAY not supported by this environment")}return function(re,ie,oe){return n(re,ie,oe,te)};default:throw new Error("format must be HEX, TEXT, B64, BYTES, ARRAYBUFFER, or UINT8ARRAY")}}function r(ne,ee,te,re){switch(ne){case"HEX":return function(ie){return function(oe,se,ae,ce){let ue,fe,he="";const le=se/8,de=ae===-1?3:0;for(ue=0;ue<le;ue+=1)fe=oe[ue>>>2]>>>8*(de+ae*(ue%4)),he+="0123456789abcdef".charAt(fe>>>4&15)+"0123456789abcdef".charAt(15&fe);return ce.outputUpper?he.toUpperCase():he}(ie,ee,te,re)};case"B64":return function(ie){return function(oe,se,ae,ce){let ue,fe,he,le,de,pe="";const me=se/8,ge=ae===-1?3:0;for(ue=0;ue<me;ue+=3)for(le=ue+1<me?oe[ue+1>>>2]:0,de=ue+2<me?oe[ue+2>>>2]:0,he=(oe[ue>>>2]>>>8*(ge+ae*(ue%4))&255)<<16|(le>>>8*(ge+ae*((ue+1)%4))&255)<<8|de>>>8*(ge+ae*((ue+2)%4))&255,fe=0;fe<4;fe+=1)pe+=8*ue+6*fe<=se?t.charAt(he>>>6*(3-fe)&63):ce.b64Pad;return pe}(ie,ee,te,re)};case"BYTES":return function(ie){return function(oe,se,ae){let ce,ue,fe="";const he=se/8,le=ae===-1?3:0;for(ce=0;ce<he;ce+=1)ue=oe[ce>>>2]>>>8*(le+ae*(ce%4))&255,fe+=String.fromCharCode(ue);return fe}(ie,ee,te)};case"ARRAYBUFFER":try{new ArrayBuffer(0)}catch{throw new Error("ARRAYBUFFER not supported by this environment")}return function(ie){return function(oe,se,ae){let ce;const ue=se/8,fe=new ArrayBuffer(ue),he=new Uint8Array(fe),le=ae===-1?3:0;for(ce=0;ce<ue;ce+=1)he[ce]=oe[ce>>>2]>>>8*(le+ae*(ce%4))&255;return fe}(ie,ee,te)};case"UINT8ARRAY":try{new Uint8Array(0)}catch{throw new Error("UINT8ARRAY not supported by this environment")}return function(ie){return function(oe,se,ae){let ce;const ue=se/8,fe=ae===-1?3:0,he=new Uint8Array(ue);for(ce=0;ce<ue;ce+=1)he[ce]=oe[ce>>>2]>>>8*(fe+ae*(ce%4))&255;return he}(ie,ee,te)};default:throw new Error("format must be HEX, B64, BYTES, ARRAYBUFFER, or UINT8ARRAY")}}const i=[1116352408,1899447441,3049323471,3921009573,961987163,1508970993,2453635748,2870763221,3624381080,310598401,607225278,1426881987,1925078388,2162078206,2614888103,3248222580,3835390401,4022224774,264347078,604807628,770255983,1249150122,1555081692,1996064986,2554220882,2821834349,2952996808,3210313671,3336571891,3584528711,113926993,338241895,666307205,773529912,1294757372,1396182291,1695183700,1986661051,2177026350,2456956037,2730485921,2820302411,3259730800,3345764771,3516065817,3600352804,4094571909,275423344,430227734,506948616,659060556,883997877,958139571,1322822218,1537002063,1747873779,1955562222,2024104815,2227730452,2361852424,2428436474,2756734187,3204031479,3329325298],s=[3238371032,914150663,812702999,4144912697,4290775857,1750603025,1694076839,3204075428],o=[1779033703,3144134277,1013904242,2773480762,1359893119,2600822924,528734635,1541459225],h="Chosen SHA variant is not supported";function u(ne,ee){let te,re;const ie=ne.binLen>>>3,oe=ee.binLen>>>3,se=ie<<3,ae=4-ie<<3;if(ie%4!=0){for(te=0;te<oe;te+=4)re=ie+te>>>2,ne.value[re]|=ee.value[te>>>2]<<se,ne.value.push(0),ne.value[re+1]|=ee.value[te>>>2]>>>ae;return(ne.value.length<<2)-4>=oe+ie&&ne.value.pop(),{value:ne.value,binLen:ne.binLen+ee.binLen}}return{value:ne.value.concat(ee.value),binLen:ne.binLen+ee.binLen}}function w(ne){const ee={outputUpper:!1,b64Pad:"=",outputLen:-1},te=ne||{},re="Output length must be a multiple of 8";if(ee.outputUpper=te.outputUpper||!1,te.b64Pad&&(ee.b64Pad=te.b64Pad),te.outputLen){if(te.outputLen%8!=0)throw new Error(re);ee.outputLen=te.outputLen}else if(te.shakeLen){if(te.shakeLen%8!=0)throw new Error(re);ee.outputLen=te.shakeLen}if(typeof ee.outputUpper!="boolean")throw new Error("Invalid outputUpper formatting option");if(typeof ee.b64Pad!="string")throw new Error("Invalid b64Pad formatting option");return ee}function c(ne,ee,te,re){const ie=ne+" must include a value and format";if(!ee){if(!re)throw new Error(ie);return re}if(ee.value===void 0||!ee.format)throw new Error(ie);return e$1(ee.format,ee.encoding||"UTF8",te)(ee.value)}class f{constructor(ee,te,re){const ie=re||{};if(this.t=te,this.i=ie.encoding||"UTF8",this.numRounds=ie.numRounds||1,isNaN(this.numRounds)||this.numRounds!==parseInt(this.numRounds,10)||1>this.numRounds)throw new Error("numRounds must a integer >= 1");this.s=ee,this.o=[],this.h=0,this.u=!1,this.l=0,this.A=!1,this.H=[],this.S=[]}update(ee){let te,re=0;const ie=this.p>>>5,oe=this.m(ee,this.o,this.h),se=oe.binLen,ae=oe.value,ce=se>>>5;for(te=0;te<ce;te+=ie)re+this.p<=se&&(this.C=this.R(ae.slice(te,te+ie),this.C),re+=this.p);this.l+=re,this.o=ae.slice(re>>>5),this.h=se%this.p,this.u=!0}getHash(ee,te){let re,ie,oe=this.U;const se=w(te);if(this.v){if(se.outputLen===-1)throw new Error("Output length must be specified in options");oe=se.outputLen}const ae=r(ee,oe,this.K,se);if(this.A&&this.T)return ae(this.T(se));for(ie=this.F(this.o.slice(),this.h,this.l,this.g(this.C),oe),re=1;re<this.numRounds;re+=1)this.v&&oe%32!=0&&(ie[ie.length-1]&=16777215>>>24-oe%32),ie=this.F(ie,oe,0,this.B(this.s),oe);return ae(ie)}setHMACKey(ee,te,re){if(!this.L)throw new Error("Variant does not support HMAC");if(this.u)throw new Error("Cannot set MAC key after calling update");const ie=e$1(te,(re||{}).encoding||"UTF8",this.K);this.M(ie(ee))}M(ee){const te=this.p>>>3,re=te/4-1;let ie;if(this.numRounds!==1)throw new Error("Cannot set numRounds with MAC");if(this.A)throw new Error("MAC key already set");for(te<ee.binLen/8&&(ee.value=this.F(ee.value,ee.binLen,0,this.B(this.s),this.U));ee.value.length<=re;)ee.value.push(0);for(ie=0;ie<=re;ie+=1)this.H[ie]=909522486^ee.value[ie],this.S[ie]=1549556828^ee.value[ie];this.C=this.R(this.H,this.C),this.l=this.p,this.A=!0}getHMAC(ee,te){const re=w(te);return r(ee,this.U,this.K,re)(this.k())}k(){let ee;if(!this.A)throw new Error("Cannot call getHMAC without first setting MAC key");const te=this.F(this.o.slice(),this.h,this.l,this.g(this.C),this.U);return ee=this.R(this.S,this.B(this.s)),ee=this.F(te,this.U,this.p,ee,this.U),ee}}function a(ne,ee){return ne<<ee|ne>>>32-ee}function l(ne,ee){return ne>>>ee|ne<<32-ee}function A(ne,ee){return ne>>>ee}function E(ne,ee,te){return ne^ee^te}function H(ne,ee,te){return ne&ee^~ne&te}function S(ne,ee,te){return ne&ee^ne&te^ee&te}function b(ne){return l(ne,2)^l(ne,13)^l(ne,22)}function p(ne,ee){const te=(65535&ne)+(65535&ee);return(65535&(ne>>>16)+(ee>>>16)+(te>>>16))<<16|65535&te}function d(ne,ee,te,re){const ie=(65535&ne)+(65535&ee)+(65535&te)+(65535&re);return(65535&(ne>>>16)+(ee>>>16)+(te>>>16)+(re>>>16)+(ie>>>16))<<16|65535&ie}function m(ne,ee,te,re,ie){const oe=(65535&ne)+(65535&ee)+(65535&te)+(65535&re)+(65535&ie);return(65535&(ne>>>16)+(ee>>>16)+(te>>>16)+(re>>>16)+(ie>>>16)+(oe>>>16))<<16|65535&oe}function C(ne){return l(ne,7)^l(ne,18)^A(ne,3)}function y(ne){return l(ne,6)^l(ne,11)^l(ne,25)}function R(ne){return[1732584193,4023233417,2562383102,271733878,3285377520]}function U(ne,ee){let te,re,ie,oe,se,ae,ce;const ue=[];for(te=ee[0],re=ee[1],ie=ee[2],oe=ee[3],se=ee[4],ce=0;ce<80;ce+=1)ue[ce]=ce<16?ne[ce]:a(ue[ce-3]^ue[ce-8]^ue[ce-14]^ue[ce-16],1),ae=ce<20?m(a(te,5),H(re,ie,oe),se,1518500249,ue[ce]):ce<40?m(a(te,5),E(re,ie,oe),se,1859775393,ue[ce]):ce<60?m(a(te,5),S(re,ie,oe),se,2400959708,ue[ce]):m(a(te,5),E(re,ie,oe),se,3395469782,ue[ce]),se=oe,oe=ie,ie=a(re,30),re=te,te=ae;return ee[0]=p(te,ee[0]),ee[1]=p(re,ee[1]),ee[2]=p(ie,ee[2]),ee[3]=p(oe,ee[3]),ee[4]=p(se,ee[4]),ee}function v(ne,ee,te,re){let ie;const oe=15+(ee+65>>>9<<4),se=ee+te;for(;ne.length<=oe;)ne.push(0);for(ne[ee>>>5]|=128<<24-ee%32,ne[oe]=4294967295&se,ne[oe-1]=se/4294967296|0,ie=0;ie<ne.length;ie+=16)re=U(ne.slice(ie,ie+16),re);return re}class K extends f{constructor(ee,te,re){if(ee!=="SHA-1")throw new Error(h);super(ee,te,re);const ie=re||{};this.L=!0,this.T=this.k,this.K=-1,this.m=e$1(this.t,this.i,this.K),this.R=U,this.g=function(oe){return oe.slice()},this.B=R,this.F=v,this.C=[1732584193,4023233417,2562383102,271733878,3285377520],this.p=512,this.U=160,this.v=!1,ie.hmacKey&&this.M(c("hmacKey",ie.hmacKey,this.K))}}function T(ne){let ee;return ee=ne=="SHA-224"?s.slice():o.slice(),ee}function F(ne,ee){let te,re,ie,oe,se,ae,ce,ue,fe,he,le;const de=[];for(te=ee[0],re=ee[1],ie=ee[2],oe=ee[3],se=ee[4],ae=ee[5],ce=ee[6],ue=ee[7],le=0;le<64;le+=1)de[le]=le<16?ne[le]:d(l(pe=de[le-2],17)^l(pe,19)^A(pe,10),de[le-7],C(de[le-15]),de[le-16]),fe=m(ue,y(se),H(se,ae,ce),i[le],de[le]),he=p(b(te),S(te,re,ie)),ue=ce,ce=ae,ae=se,se=p(oe,fe),oe=ie,ie=re,re=te,te=p(fe,he);var pe;return ee[0]=p(te,ee[0]),ee[1]=p(re,ee[1]),ee[2]=p(ie,ee[2]),ee[3]=p(oe,ee[3]),ee[4]=p(se,ee[4]),ee[5]=p(ae,ee[5]),ee[6]=p(ce,ee[6]),ee[7]=p(ue,ee[7]),ee}class g extends f{constructor(ee,te,re){if(ee!=="SHA-224"&&ee!=="SHA-256")throw new Error(h);super(ee,te,re);const ie=re||{};this.T=this.k,this.L=!0,this.K=-1,this.m=e$1(this.t,this.i,this.K),this.R=F,this.g=function(oe){return oe.slice()},this.B=T,this.F=function(oe,se,ae,ce){return function(ue,fe,he,le,de){let pe,me;const ge=15+(fe+65>>>9<<4),we=fe+he;for(;ue.length<=ge;)ue.push(0);for(ue[fe>>>5]|=128<<24-fe%32,ue[ge]=4294967295&we,ue[ge-1]=we/4294967296|0,pe=0;pe<ue.length;pe+=16)le=F(ue.slice(pe,pe+16),le);return me=de==="SHA-224"?[le[0],le[1],le[2],le[3],le[4],le[5],le[6]]:le,me}(oe,se,ae,ce,ee)},this.C=T(ee),this.p=512,this.U=ee==="SHA-224"?224:256,this.v=!1,ie.hmacKey&&this.M(c("hmacKey",ie.hmacKey,this.K))}}class B{constructor(ee,te){this.Y=ee,this.N=te}}function L(ne,ee){let te;return ee>32?(te=64-ee,new B(ne.N<<ee|ne.Y>>>te,ne.Y<<ee|ne.N>>>te)):ee!==0?(te=32-ee,new B(ne.Y<<ee|ne.N>>>te,ne.N<<ee|ne.Y>>>te)):ne}function M(ne,ee){let te;return ee<32?(te=32-ee,new B(ne.Y>>>ee|ne.N<<te,ne.N>>>ee|ne.Y<<te)):(te=64-ee,new B(ne.N>>>ee|ne.Y<<te,ne.Y>>>ee|ne.N<<te))}function k(ne,ee){return new B(ne.Y>>>ee,ne.N>>>ee|ne.Y<<32-ee)}function Y(ne,ee,te){return new B(ne.Y&ee.Y^ne.Y&te.Y^ee.Y&te.Y,ne.N&ee.N^ne.N&te.N^ee.N&te.N)}function N(ne){const ee=M(ne,28),te=M(ne,34),re=M(ne,39);return new B(ee.Y^te.Y^re.Y,ee.N^te.N^re.N)}function I(ne,ee){let te,re;te=(65535&ne.N)+(65535&ee.N),re=(ne.N>>>16)+(ee.N>>>16)+(te>>>16);const ie=(65535&re)<<16|65535&te;return te=(65535&ne.Y)+(65535&ee.Y)+(re>>>16),re=(ne.Y>>>16)+(ee.Y>>>16)+(te>>>16),new B((65535&re)<<16|65535&te,ie)}function X(ne,ee,te,re){let ie,oe;ie=(65535&ne.N)+(65535&ee.N)+(65535&te.N)+(65535&re.N),oe=(ne.N>>>16)+(ee.N>>>16)+(te.N>>>16)+(re.N>>>16)+(ie>>>16);const se=(65535&oe)<<16|65535&ie;return ie=(65535&ne.Y)+(65535&ee.Y)+(65535&te.Y)+(65535&re.Y)+(oe>>>16),oe=(ne.Y>>>16)+(ee.Y>>>16)+(te.Y>>>16)+(re.Y>>>16)+(ie>>>16),new B((65535&oe)<<16|65535&ie,se)}function z(ne,ee,te,re,ie){let oe,se;oe=(65535&ne.N)+(65535&ee.N)+(65535&te.N)+(65535&re.N)+(65535&ie.N),se=(ne.N>>>16)+(ee.N>>>16)+(te.N>>>16)+(re.N>>>16)+(ie.N>>>16)+(oe>>>16);const ae=(65535&se)<<16|65535&oe;return oe=(65535&ne.Y)+(65535&ee.Y)+(65535&te.Y)+(65535&re.Y)+(65535&ie.Y)+(se>>>16),se=(ne.Y>>>16)+(ee.Y>>>16)+(te.Y>>>16)+(re.Y>>>16)+(ie.Y>>>16)+(oe>>>16),new B((65535&se)<<16|65535&oe,ae)}function x(ne,ee){return new B(ne.Y^ee.Y,ne.N^ee.N)}function _(ne){const ee=M(ne,19),te=M(ne,61),re=k(ne,6);return new B(ee.Y^te.Y^re.Y,ee.N^te.N^re.N)}function O(ne){const ee=M(ne,1),te=M(ne,8),re=k(ne,7);return new B(ee.Y^te.Y^re.Y,ee.N^te.N^re.N)}function P(ne){const ee=M(ne,14),te=M(ne,18),re=M(ne,41);return new B(ee.Y^te.Y^re.Y,ee.N^te.N^re.N)}const V=[new B(i[0],3609767458),new B(i[1],602891725),new B(i[2],3964484399),new B(i[3],2173295548),new B(i[4],4081628472),new B(i[5],3053834265),new B(i[6],2937671579),new B(i[7],3664609560),new B(i[8],2734883394),new B(i[9],1164996542),new B(i[10],1323610764),new B(i[11],3590304994),new B(i[12],4068182383),new B(i[13],991336113),new B(i[14],633803317),new B(i[15],3479774868),new B(i[16],2666613458),new B(i[17],944711139),new B(i[18],2341262773),new B(i[19],2007800933),new B(i[20],1495990901),new B(i[21],1856431235),new B(i[22],3175218132),new B(i[23],2198950837),new B(i[24],3999719339),new B(i[25],766784016),new B(i[26],2566594879),new B(i[27],3203337956),new B(i[28],1034457026),new B(i[29],2466948901),new B(i[30],3758326383),new B(i[31],168717936),new B(i[32],1188179964),new B(i[33],1546045734),new B(i[34],1522805485),new B(i[35],2643833823),new B(i[36],2343527390),new B(i[37],1014477480),new B(i[38],1206759142),new B(i[39],344077627),new B(i[40],1290863460),new B(i[41],3158454273),new B(i[42],3505952657),new B(i[43],106217008),new B(i[44],3606008344),new B(i[45],1432725776),new B(i[46],1467031594),new B(i[47],851169720),new B(i[48],3100823752),new B(i[49],1363258195),new B(i[50],3750685593),new B(i[51],3785050280),new B(i[52],3318307427),new B(i[53],3812723403),new B(i[54],2003034995),new B(i[55],3602036899),new B(i[56],1575990012),new B(i[57],1125592928),new B(i[58],2716904306),new B(i[59],442776044),new B(i[60],593698344),new B(i[61],3733110249),new B(i[62],2999351573),new B(i[63],3815920427),new B(3391569614,3928383900),new B(3515267271,566280711),new B(3940187606,3454069534),new B(4118630271,4000239992),new B(116418474,1914138554),new B(174292421,2731055270),new B(289380356,3203993006),new B(460393269,320620315),new B(685471733,587496836),new B(852142971,1086792851),new B(1017036298,365543100),new B(1126000580,2618297676),new B(1288033470,3409855158),new B(1501505948,4234509866),new B(1607167915,987167468),new B(1816402316,1246189591)];function Z(ne){return ne==="SHA-384"?[new B(3418070365,s[0]),new B(1654270250,s[1]),new B(2438529370,s[2]),new B(355462360,s[3]),new B(1731405415,s[4]),new B(41048885895,s[5]),new B(3675008525,s[6]),new B(1203062813,s[7])]:[new B(o[0],4089235720),new B(o[1],2227873595),new B(o[2],4271175723),new B(o[3],1595750129),new B(o[4],2917565137),new B(o[5],725511199),new B(o[6],4215389547),new B(o[7],327033209)]}function j(ne,ee){let te,re,ie,oe,se,ae,ce,ue,fe,he,le,de;const pe=[];for(te=ee[0],re=ee[1],ie=ee[2],oe=ee[3],se=ee[4],ae=ee[5],ce=ee[6],ue=ee[7],le=0;le<80;le+=1)le<16?(de=2*le,pe[le]=new B(ne[de],ne[de+1])):pe[le]=X(_(pe[le-2]),pe[le-7],O(pe[le-15]),pe[le-16]),fe=z(ue,P(se),(ge=ae,we=ce,new B((me=se).Y&ge.Y^~me.Y&we.Y,me.N&ge.N^~me.N&we.N)),V[le],pe[le]),he=I(N(te),Y(te,re,ie)),ue=ce,ce=ae,ae=se,se=I(oe,fe),oe=ie,ie=re,re=te,te=I(fe,he);var me,ge,we;return ee[0]=I(te,ee[0]),ee[1]=I(re,ee[1]),ee[2]=I(ie,ee[2]),ee[3]=I(oe,ee[3]),ee[4]=I(se,ee[4]),ee[5]=I(ae,ee[5]),ee[6]=I(ce,ee[6]),ee[7]=I(ue,ee[7]),ee}class q extends f{constructor(ee,te,re){if(ee!=="SHA-384"&&ee!=="SHA-512")throw new Error(h);super(ee,te,re);const ie=re||{};this.T=this.k,this.L=!0,this.K=-1,this.m=e$1(this.t,this.i,this.K),this.R=j,this.g=function(oe){return oe.slice()},this.B=Z,this.F=function(oe,se,ae,ce){return function(ue,fe,he,le,de){let pe,me;const ge=31+(fe+129>>>10<<5),we=fe+he;for(;ue.length<=ge;)ue.push(0);for(ue[fe>>>5]|=128<<24-fe%32,ue[ge]=4294967295&we,ue[ge-1]=we/4294967296|0,pe=0;pe<ue.length;pe+=32)le=j(ue.slice(pe,pe+32),le);return me=de==="SHA-384"?[(le=le)[0].Y,le[0].N,le[1].Y,le[1].N,le[2].Y,le[2].N,le[3].Y,le[3].N,le[4].Y,le[4].N,le[5].Y,le[5].N]:[le[0].Y,le[0].N,le[1].Y,le[1].N,le[2].Y,le[2].N,le[3].Y,le[3].N,le[4].Y,le[4].N,le[5].Y,le[5].N,le[6].Y,le[6].N,le[7].Y,le[7].N],me}(oe,se,ae,ce,ee)},this.C=Z(ee),this.p=1024,this.U=ee==="SHA-384"?384:512,this.v=!1,ie.hmacKey&&this.M(c("hmacKey",ie.hmacKey,this.K))}}const D=[new B(0,1),new B(0,32898),new B(2147483648,32906),new B(2147483648,2147516416),new B(0,32907),new B(0,2147483649),new B(2147483648,2147516545),new B(2147483648,32777),new B(0,138),new B(0,136),new B(0,2147516425),new B(0,2147483658),new B(0,2147516555),new B(2147483648,139),new B(2147483648,32905),new B(2147483648,32771),new B(2147483648,32770),new B(2147483648,128),new B(0,32778),new B(2147483648,2147483658),new B(2147483648,2147516545),new B(2147483648,32896),new B(0,2147483649),new B(2147483648,2147516424)],G=[[0,36,3,41,18],[1,44,10,45,2],[62,6,43,15,61],[28,55,25,21,56],[27,20,39,8,14]];function J(ne){let ee;const te=[];for(ee=0;ee<5;ee+=1)te[ee]=[new B(0,0),new B(0,0),new B(0,0),new B(0,0),new B(0,0)];return te}function Q(ne){let ee;const te=[];for(ee=0;ee<5;ee+=1)te[ee]=ne[ee].slice();return te}function W(ne,ee){let te,re,ie,oe;const se=[],ae=[];if(ne!==null)for(re=0;re<ne.length;re+=2)ee[(re>>>1)%5][(re>>>1)/5|0]=x(ee[(re>>>1)%5][(re>>>1)/5|0],new B(ne[re+1],ne[re]));for(te=0;te<24;te+=1){for(oe=J(),re=0;re<5;re+=1)se[re]=(ce=ee[re][0],ue=ee[re][1],fe=ee[re][2],he=ee[re][3],le=ee[re][4],new B(ce.Y^ue.Y^fe.Y^he.Y^le.Y,ce.N^ue.N^fe.N^he.N^le.N));for(re=0;re<5;re+=1)ae[re]=x(se[(re+4)%5],L(se[(re+1)%5],1));for(re=0;re<5;re+=1)for(ie=0;ie<5;ie+=1)ee[re][ie]=x(ee[re][ie],ae[re]);for(re=0;re<5;re+=1)for(ie=0;ie<5;ie+=1)oe[ie][(2*re+3*ie)%5]=L(ee[re][ie],G[re][ie]);for(re=0;re<5;re+=1)for(ie=0;ie<5;ie+=1)ee[re][ie]=x(oe[re][ie],new B(~oe[(re+1)%5][ie].Y&oe[(re+2)%5][ie].Y,~oe[(re+1)%5][ie].N&oe[(re+2)%5][ie].N));ee[0][0]=x(ee[0][0],D[te])}var ce,ue,fe,he,le;return ee}function $(ne){let ee,te,re=0;const ie=[0,0],oe=[4294967295&ne,ne/4294967296&2097151];for(ee=6;ee>=0;ee--)te=oe[ee>>2]>>>8*ee&255,te===0&&re===0||(ie[re+1>>2]|=te<<8*(re+1),re+=1);return re=re!==0?re:1,ie[0]|=re,{value:re+1>4?ie:[ie[0]],binLen:8+8*re}}function tt(ne){return u($(ne.binLen),ne)}function nt(ne,ee){let te,re=$(ee);re=u(re,ne);const ie=ee>>>2,oe=(ie-re.value.length%ie)%ie;for(te=0;te<oe;te++)re.value.push(0);return re.value}class et extends f{constructor(ee,te,re){let ie=6,oe=0;super(ee,te,re);const se=re||{};if(this.numRounds!==1){if(se.kmacKey||se.hmacKey)throw new Error("Cannot set numRounds with MAC");if(this.s==="CSHAKE128"||this.s==="CSHAKE256")throw new Error("Cannot set numRounds for CSHAKE variants")}switch(this.K=1,this.m=e$1(this.t,this.i,this.K),this.R=W,this.g=Q,this.B=J,this.C=J(),this.v=!1,ee){case"SHA3-224":this.p=oe=1152,this.U=224,this.L=!0,this.T=this.k;break;case"SHA3-256":this.p=oe=1088,this.U=256,this.L=!0,this.T=this.k;break;case"SHA3-384":this.p=oe=832,this.U=384,this.L=!0,this.T=this.k;break;case"SHA3-512":this.p=oe=576,this.U=512,this.L=!0,this.T=this.k;break;case"SHAKE128":ie=31,this.p=oe=1344,this.U=-1,this.v=!0,this.L=!1,this.T=null;break;case"SHAKE256":ie=31,this.p=oe=1088,this.U=-1,this.v=!0,this.L=!1,this.T=null;break;case"KMAC128":ie=4,this.p=oe=1344,this.I(re),this.U=-1,this.v=!0,this.L=!1,this.T=this.X;break;case"KMAC256":ie=4,this.p=oe=1088,this.I(re),this.U=-1,this.v=!0,this.L=!1,this.T=this.X;break;case"CSHAKE128":this.p=oe=1344,ie=this._(re),this.U=-1,this.v=!0,this.L=!1,this.T=null;break;case"CSHAKE256":this.p=oe=1088,ie=this._(re),this.U=-1,this.v=!0,this.L=!1,this.T=null;break;default:throw new Error(h)}this.F=function(ae,ce,ue,fe,he){return function(le,de,pe,me,ge,we,ve){let _e,ye,Be=0;const be=[],Se=ge>>>5,Ee=de>>>5;for(_e=0;_e<Ee&&de>=ge;_e+=Se)me=W(le.slice(_e,_e+Se),me),de-=ge;for(le=le.slice(_e),de%=ge;le.length<Se;)le.push(0);for(_e=de>>>3,le[_e>>2]^=we<<_e%4*8,le[Se-1]^=2147483648,me=W(le,me);32*be.length<ve&&(ye=me[Be%5][Be/5|0],be.push(ye.N),!(32*be.length>=ve));)be.push(ye.Y),Be+=1,64*Be%ge==0&&(W(null,me),Be=0);return be}(ae,ce,0,fe,oe,ie,he)},se.hmacKey&&this.M(c("hmacKey",se.hmacKey,this.K))}_(ee,te){const re=function(oe){const se=oe||{};return{funcName:c("funcName",se.funcName,1,{value:[],binLen:0}),customization:c("Customization",se.customization,1,{value:[],binLen:0})}}(ee||{});te&&(re.funcName=te);const ie=u(tt(re.funcName),tt(re.customization));if(re.customization.binLen!==0||re.funcName.binLen!==0){const oe=nt(ie,this.p>>>3);for(let se=0;se<oe.length;se+=this.p>>>5)this.C=this.R(oe.slice(se,se+(this.p>>>5)),this.C),this.l+=this.p;return 4}return 31}I(ee){const te=function(ie){const oe=ie||{};return{kmacKey:c("kmacKey",oe.kmacKey,1),funcName:{value:[1128353099],binLen:32},customization:c("Customization",oe.customization,1,{value:[],binLen:0})}}(ee||{});this._(ee,te.funcName);const re=nt(tt(te.kmacKey),this.p>>>3);for(let ie=0;ie<re.length;ie+=this.p>>>5)this.C=this.R(re.slice(ie,ie+(this.p>>>5)),this.C),this.l+=this.p;this.A=!0}X(ee){const te=u({value:this.o.slice(),binLen:this.h},function(re){let ie,oe,se=0;const ae=[0,0],ce=[4294967295&re,re/4294967296&2097151];for(ie=6;ie>=0;ie--)oe=ce[ie>>2]>>>8*ie&255,oe===0&&se===0||(ae[se>>2]|=oe<<8*se,se+=1);return se=se!==0?se:1,ae[se>>2]|=se<<8*se,{value:se+1>4?ae:[ae[0]],binLen:8+8*se}}(ee.outputLen));return this.F(te.value,te.binLen,this.l,this.g(this.C),ee.outputLen)}}class jsSHA{constructor(ee,te,re){if(ee=="SHA-1")this.O=new K(ee,te,re);else if(ee=="SHA-224"||ee=="SHA-256")this.O=new g(ee,te,re);else if(ee=="SHA-384"||ee=="SHA-512")this.O=new q(ee,te,re);else{if(ee!="SHA3-224"&&ee!="SHA3-256"&&ee!="SHA3-384"&&ee!="SHA3-512"&&ee!="SHAKE128"&&ee!="SHAKE256"&&ee!="CSHAKE128"&&ee!="CSHAKE256"&&ee!="KMAC128"&&ee!="KMAC256")throw new Error(h);this.O=new et(ee,te,re)}}update(ee){this.O.update(ee)}getHash(ee,te){return this.O.getHash(ee,te)}setHMACKey(ee,te,re){this.O.setHMACKey(ee,te,re)}getHMAC(ee,te){return this.O.getHMAC(ee,te)}}const globalScope=(()=>{if(typeof globalThis=="object")return globalThis;Object.defineProperty(Object.prototype,"__GLOBALTHIS__",{get(){return this},configurable:!0});try{if(typeof __GLOBALTHIS__<"u")return __GLOBALTHIS__}finally{delete Object.prototype.__GLOBALTHIS__}if(typeof self<"u")return self;if(typeof window<"u")return window;if(typeof global<"u")return global})(),isNode=Object.prototype.toString.call(globalScope.process)==="[object process]",nodeRequire=isNode?eval("require"):()=>{},NodeCrypto$2=isNode?nodeRequire("crypto"):void 0,OPENSSL_TO_JSSHA_ALGO={SHA1:"SHA-1",SHA224:"SHA-224",SHA256:"SHA-256",SHA384:"SHA-384",SHA512:"SHA-512","SHA3-224":"SHA3-224","SHA3-256":"SHA3-256","SHA3-384":"SHA3-384","SHA3-512":"SHA3-512"},hmacDigest=(ne,ee,te)=>{if(isNode){const re=NodeCrypto$2.createHmac(ne,globalScope.Buffer.from(ee));return re.update(globalScope.Buffer.from(te)),re.digest().buffer}else{const re=OPENSSL_TO_JSSHA_ALGO[ne.toUpperCase()];if(typeof re>"u")throw new TypeError("Unknown hash function");const ie=new jsSHA(re,"ARRAYBUFFER");return ie.setHMACKey(ee,"ARRAYBUFFER"),ie.update(te),ie.getHMAC("ARRAYBUFFER")}},pad=(ne,ee)=>{let te="",re=ee-String(ne).length;for(;re-- >0;)te+="0";return`${te}${ne}`},ALPHABET="ABCDEFGHIJKLMNOPQRSTUVWXYZ234567",base32ToBuf=ne=>{let ee=ne.length;for(;ne[ee-1]==="=";)--ee;const te=(ee<ne.length?ne.substring(0,ee):ne).toUpperCase(),re=new ArrayBuffer(te.length*5/8|0),ie=new Uint8Array(re);let oe=0,se=0,ae=0;for(let ce=0;ce<te.length;ce++){const ue=ALPHABET.indexOf(te[ce]);if(ue===-1)throw new TypeError(`Invalid character found: ${te[ce]}`);se=se<<5|ue,oe+=5,oe>=8&&(oe-=8,ie[ae++]=se>>>oe)}return re},base32FromBuf=ne=>{const ee=new Uint8Array(ne);let te=0,re=0,ie="";for(let oe=0;oe<ee.length;oe++)for(re=re<<8|ee[oe],te+=8;te>=5;)ie+=ALPHABET[re>>>te-5&31],te-=5;return te>0&&(ie+=ALPHABET[re<<5-te&31]),ie},hexToBuf=ne=>{const ee=new ArrayBuffer(ne.length/2),te=new Uint8Array(ee);for(let re=0;re<ne.length;re+=2)te[re/2]=parseInt(ne.substr(re,2),16);return ee},hexFromBuf=ne=>{const ee=new Uint8Array(ne);let te="";for(let re=0;re<ee.length;re++){const ie=ee[re].toString(16);ie.length===1&&(te+="0"),te+=ie}return te.toUpperCase()},latin1ToBuf=ne=>{const ee=new ArrayBuffer(ne.length),te=new Uint8Array(ee);for(let re=0;re<ne.length;re++)te[re]=ne.charCodeAt(re)&255;return ee},latin1FromBuf=ne=>{const ee=new Uint8Array(ne);let te="";for(let re=0;re<ee.length;re++)te+=String.fromCharCode(ee[re]);return te},ENCODER=globalScope.TextEncoder?new globalScope.TextEncoder("utf-8"):null,DECODER=globalScope.TextDecoder?new globalScope.TextDecoder("utf-8"):null,utf8ToBuf=ne=>{if(!ENCODER)throw new Error("Encoding API not available");return ENCODER.encode(ne).buffer},utf8FromBuf=ne=>{if(!DECODER)throw new Error("Encoding API not available");return DECODER.decode(ne)},NodeCrypto$1=isNode?nodeRequire("crypto"):void 0,randomBytes=ne=>{if(isNode)return NodeCrypto$1.randomBytes(ne).buffer;if(!globalScope.crypto||!globalScope.crypto.getRandomValues)throw new Error("Cryptography API not available");return globalScope.crypto.getRandomValues(new Uint8Array(ne)).buffer};class Secret{constructor(){let{buffer:ee,size:te=20}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};this.buffer=typeof ee>"u"?randomBytes(te):ee}static fromLatin1(ee){return new Secret({buffer:latin1ToBuf(ee)})}static fromUTF8(ee){return new Secret({buffer:utf8ToBuf(ee)})}static fromBase32(ee){return new Secret({buffer:base32ToBuf(ee)})}static fromHex(ee){return new Secret({buffer:hexToBuf(ee)})}get latin1(){return Object.defineProperty(this,"latin1",{enumerable:!0,value:latin1FromBuf(this.buffer)}),this.latin1}get utf8(){return Object.defineProperty(this,"utf8",{enumerable:!0,value:utf8FromBuf(this.buffer)}),this.utf8}get base32(){return Object.defineProperty(this,"base32",{enumerable:!0,value:base32FromBuf(this.buffer)}),this.base32}get hex(){return Object.defineProperty(this,"hex",{enumerable:!0,value:hexFromBuf(this.buffer)}),this.hex}}const NodeCrypto=isNode?nodeRequire("crypto"):void 0,timingSafeEqual=(ne,ee)=>{if(isNode)return NodeCrypto.timingSafeEqual(globalScope.Buffer.from(ne),globalScope.Buffer.from(ee));{if(ne.length!==ee.length)throw new TypeError("Input strings must have the same length");let te=-1,re=0;for(;++te<ne.length;)re|=ne.charCodeAt(te)^ee.charCodeAt(te);return re===0}};class HOTP{static get defaults(){return{issuer:"",label:"OTPAuth",algorithm:"SHA1",digits:6,counter:0,window:1}}constructor(){let{issuer:ee=HOTP.defaults.issuer,label:te=HOTP.defaults.label,secret:re=new Secret,algorithm:ie=HOTP.defaults.algorithm,digits:oe=HOTP.defaults.digits,counter:se=HOTP.defaults.counter}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};this.issuer=ee,this.label=te,this.secret=typeof re=="string"?Secret.fromBase32(re):re,this.algorithm=ie.toUpperCase(),this.digits=oe,this.counter=se}static generate(ee){let{secret:te,algorithm:re=HOTP.defaults.algorithm,digits:ie=HOTP.defaults.digits,counter:oe=HOTP.defaults.counter}=ee;const se=new Uint8Array(hmacDigest(re,te.buffer,uintToBuf(oe))),ae=se[se.byteLength-1]&15,ce=((se[ae]&127)<<24|(se[ae+1]&255)<<16|(se[ae+2]&255)<<8|se[ae+3]&255)%10**ie;return pad(ce,ie)}generate(){let{counter:ee=this.counter++}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};return HOTP.generate({secret:this.secret,algorithm:this.algorithm,digits:this.digits,counter:ee})}static validate(ee){let{token:te,secret:re,algorithm:ie,digits:oe,counter:se=HOTP.defaults.counter,window:ae=HOTP.defaults.window}=ee;if(te.length!==oe)return null;let ce=null;for(let ue=se-ae;ue<=se+ae;++ue){const fe=HOTP.generate({secret:re,algorithm:ie,digits:oe,counter:ue});timingSafeEqual(te,fe)&&(ce=ue-se)}return ce}validate(ee){let{token:te,counter:re=this.counter,window:ie}=ee;return HOTP.validate({token:te,secret:this.secret,algorithm:this.algorithm,digits:this.digits,counter:re,window:ie})}toString(){const ee=encodeURIComponent;return`otpauth://hotp/${this.issuer.length>0?`${ee(this.issuer)}:${ee(this.label)}?issuer=${ee(this.issuer)}&`:`${ee(this.label)}?`}secret=${ee(this.secret.base32)}&algorithm=${ee(this.algorithm)}&digits=${ee(this.digits)}&counter=${ee(this.counter)}`}}class TOTP{static get defaults(){return{issuer:"",label:"OTPAuth",algorithm:"SHA1",digits:6,period:30,window:1}}constructor(){let{issuer:ee=TOTP.defaults.issuer,label:te=TOTP.defaults.label,secret:re=new Secret,algorithm:ie=TOTP.defaults.algorithm,digits:oe=TOTP.defaults.digits,period:se=TOTP.defaults.period}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};this.issuer=ee,this.label=te,this.secret=typeof re=="string"?Secret.fromBase32(re):re,this.algorithm=ie.toUpperCase(),this.digits=oe,this.period=se}static generate(ee){let{secret:te,algorithm:re,digits:ie,period:oe=TOTP.defaults.period,timestamp:se=Date.now()}=ee;return HOTP.generate({secret:te,algorithm:re,digits:ie,counter:Math.floor(se/1e3/oe)})}generate(){let{timestamp:ee=Date.now()}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};return TOTP.generate({secret:this.secret,algorithm:this.algorithm,digits:this.digits,period:this.period,timestamp:ee})}static validate(ee){let{token:te,secret:re,algorithm:ie,digits:oe,period:se=TOTP.defaults.period,timestamp:ae=Date.now(),window:ce}=ee;return HOTP.validate({token:te,secret:re,algorithm:ie,digits:oe,counter:Math.floor(ae/1e3/se),window:ce})}validate(ee){let{token:te,timestamp:re,window:ie}=ee;return TOTP.validate({token:te,secret:this.secret,algorithm:this.algorithm,digits:this.digits,period:this.period,timestamp:re,window:ie})}toString(){const ee=encodeURIComponent;return`otpauth://totp/${this.issuer.length>0?`${ee(this.issuer)}:${ee(this.label)}?issuer=${ee(this.issuer)}&`:`${ee(this.label)}?`}secret=${ee(this.secret.base32)}&algorithm=${ee(this.algorithm)}&digits=${ee(this.digits)}&period=${ee(this.period)}`}}function getTimeUntilTOTPChange(){return 30-new Date().getSeconds()%30}function newTOTP(ne){return new TOTP({digits:6,period:30,secret:ne})}function randomSecret(){return Math.random().toString(36).substring(2)+Math.random().toString(36).substring(2)+Math.random().toString(36).substring(2)}const syncIcon="/assets/sync-outline.06853ffe.svg",settingsIcon="/assets/settings-outline.2e47e9ab.svg",subscriber_queue=[];function readable(ne,ee){return{subscribe:writable(ne,ee).subscribe}}function writable(ne,ee=noop){let te;const re=new Set;function ie(ae){if(safe_not_equal(ne,ae)&&(ne=ae,te)){const ce=!subscriber_queue.length;for(const ue of re)ue[1](),subscriber_queue.push(ue,ne);if(ce){for(let ue=0;ue<subscriber_queue.length;ue+=2)subscriber_queue[ue][0](subscriber_queue[ue+1]);subscriber_queue.length=0}}}function oe(ae){ie(ae(ne))}function se(ae,ce=noop){const ue=[ae,ce];return re.add(ue),re.size===1&&(te=ee(ie)||noop),ae(ne),()=>{re.delete(ue),re.size===0&&(te(),te=null)}}return{set:ie,update:oe,subscribe:se}}var global$1=typeof global<"u"?global:typeof self<"u"?self:typeof window<"u"?window:{},lookup=[],revLookup=[],Arr=typeof Uint8Array<"u"?Uint8Array:Array,inited=!1;function init(){inited=!0;for(var ne="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",ee=0,te=ne.length;ee<te;++ee)lookup[ee]=ne[ee],revLookup[ne.charCodeAt(ee)]=ee;revLookup["-".charCodeAt(0)]=62,revLookup["_".charCodeAt(0)]=63}function toByteArray(ne){inited||init();var ee,te,re,ie,oe,se,ae=ne.length;if(ae%4>0)throw new Error("Invalid string. Length must be a multiple of 4");oe=ne[ae-2]==="="?2:ne[ae-1]==="="?1:0,se=new Arr(ae*3/4-oe),re=oe>0?ae-4:ae;var ce=0;for(ee=0,te=0;ee<re;ee+=4,te+=3)ie=revLookup[ne.charCodeAt(ee)]<<18|revLookup[ne.charCodeAt(ee+1)]<<12|revLookup[ne.charCodeAt(ee+2)]<<6|revLookup[ne.charCodeAt(ee+3)],se[ce++]=ie>>16&255,se[ce++]=ie>>8&255,se[ce++]=ie&255;return oe===2?(ie=revLookup[ne.charCodeAt(ee)]<<2|revLookup[ne.charCodeAt(ee+1)]>>4,se[ce++]=ie&255):oe===1&&(ie=revLookup[ne.charCodeAt(ee)]<<10|revLookup[ne.charCodeAt(ee+1)]<<4|revLookup[ne.charCodeAt(ee+2)]>>2,se[ce++]=ie>>8&255,se[ce++]=ie&255),se}function tripletToBase64(ne){return lookup[ne>>18&63]+lookup[ne>>12&63]+lookup[ne>>6&63]+lookup[ne&63]}function encodeChunk(ne,ee,te){for(var re,ie=[],oe=ee;oe<te;oe+=3)re=(ne[oe]<<16)+(ne[oe+1]<<8)+ne[oe+2],ie.push(tripletToBase64(re));return ie.join("")}function fromByteArray(ne){inited||init();for(var ee,te=ne.length,re=te%3,ie="",oe=[],se=16383,ae=0,ce=te-re;ae<ce;ae+=se)oe.push(encodeChunk(ne,ae,ae+se>ce?ce:ae+se));return re===1?(ee=ne[te-1],ie+=lookup[ee>>2],ie+=lookup[ee<<4&63],ie+="=="):re===2&&(ee=(ne[te-2]<<8)+ne[te-1],ie+=lookup[ee>>10],ie+=lookup[ee>>4&63],ie+=lookup[ee<<2&63],ie+="="),oe.push(ie),oe.join("")}function read(ne,ee,te,re,ie){var oe,se,ae=ie*8-re-1,ce=(1<<ae)-1,ue=ce>>1,fe=-7,he=te?ie-1:0,le=te?-1:1,de=ne[ee+he];for(he+=le,oe=de&(1<<-fe)-1,de>>=-fe,fe+=ae;fe>0;oe=oe*256+ne[ee+he],he+=le,fe-=8);for(se=oe&(1<<-fe)-1,oe>>=-fe,fe+=re;fe>0;se=se*256+ne[ee+he],he+=le,fe-=8);if(oe===0)oe=1-ue;else{if(oe===ce)return se?NaN:(de?-1:1)*(1/0);se=se+Math.pow(2,re),oe=oe-ue}return(de?-1:1)*se*Math.pow(2,oe-re)}function write(ne,ee,te,re,ie,oe){var se,ae,ce,ue=oe*8-ie-1,fe=(1<<ue)-1,he=fe>>1,le=ie===23?Math.pow(2,-24)-Math.pow(2,-77):0,de=re?0:oe-1,pe=re?1:-1,me=ee<0||ee===0&&1/ee<0?1:0;for(ee=Math.abs(ee),isNaN(ee)||ee===1/0?(ae=isNaN(ee)?1:0,se=fe):(se=Math.floor(Math.log(ee)/Math.LN2),ee*(ce=Math.pow(2,-se))<1&&(se--,ce*=2),se+he>=1?ee+=le/ce:ee+=le*Math.pow(2,1-he),ee*ce>=2&&(se++,ce/=2),se+he>=fe?(ae=0,se=fe):se+he>=1?(ae=(ee*ce-1)*Math.pow(2,ie),se=se+he):(ae=ee*Math.pow(2,he-1)*Math.pow(2,ie),se=0));ie>=8;ne[te+de]=ae&255,de+=pe,ae/=256,ie-=8);for(se=se<<ie|ae,ue+=ie;ue>0;ne[te+de]=se&255,de+=pe,se/=256,ue-=8);ne[te+de-pe]|=me*128}var toString={}.toString,isArray=Array.isArray||function(ne){return toString.call(ne)=="[object Array]"};/*!
 * The buffer module from node.js, for the browser.
 *
 * @author   Feross Aboukhadijeh <feross@feross.org> <http://feross.org>
 * @license  MIT
 */var INSPECT_MAX_BYTES=50;Buffer.TYPED_ARRAY_SUPPORT=global$1.TYPED_ARRAY_SUPPORT!==void 0?global$1.TYPED_ARRAY_SUPPORT:!0;function kMaxLength(){return Buffer.TYPED_ARRAY_SUPPORT?2147483647:1073741823}function createBuffer(ne,ee){if(kMaxLength()<ee)throw new RangeError("Invalid typed array length");return Buffer.TYPED_ARRAY_SUPPORT?(ne=new Uint8Array(ee),ne.__proto__=Buffer.prototype):(ne===null&&(ne=new Buffer(ee)),ne.length=ee),ne}function Buffer(ne,ee,te){if(!Buffer.TYPED_ARRAY_SUPPORT&&!(this instanceof Buffer))return new Buffer(ne,ee,te);if(typeof ne=="number"){if(typeof ee=="string")throw new Error("If encoding is specified then the first argument must be a string");return allocUnsafe(this,ne)}return from(this,ne,ee,te)}Buffer.poolSize=8192;Buffer._augment=function(ne){return ne.__proto__=Buffer.prototype,ne};function from(ne,ee,te,re){if(typeof ee=="number")throw new TypeError('"value" argument must not be a number');return typeof ArrayBuffer<"u"&&ee instanceof ArrayBuffer?fromArrayBuffer(ne,ee,te,re):typeof ee=="string"?fromString(ne,ee,te):fromObject(ne,ee)}Buffer.from=function(ne,ee,te){return from(null,ne,ee,te)};Buffer.TYPED_ARRAY_SUPPORT&&(Buffer.prototype.__proto__=Uint8Array.prototype,Buffer.__proto__=Uint8Array);function assertSize(ne){if(typeof ne!="number")throw new TypeError('"size" argument must be a number');if(ne<0)throw new RangeError('"size" argument must not be negative')}function alloc(ne,ee,te,re){return assertSize(ee),ee<=0?createBuffer(ne,ee):te!==void 0?typeof re=="string"?createBuffer(ne,ee).fill(te,re):createBuffer(ne,ee).fill(te):createBuffer(ne,ee)}Buffer.alloc=function(ne,ee,te){return alloc(null,ne,ee,te)};function allocUnsafe(ne,ee){if(assertSize(ee),ne=createBuffer(ne,ee<0?0:checked(ee)|0),!Buffer.TYPED_ARRAY_SUPPORT)for(var te=0;te<ee;++te)ne[te]=0;return ne}Buffer.allocUnsafe=function(ne){return allocUnsafe(null,ne)};Buffer.allocUnsafeSlow=function(ne){return allocUnsafe(null,ne)};function fromString(ne,ee,te){if((typeof te!="string"||te==="")&&(te="utf8"),!Buffer.isEncoding(te))throw new TypeError('"encoding" must be a valid string encoding');var re=byteLength(ee,te)|0;ne=createBuffer(ne,re);var ie=ne.write(ee,te);return ie!==re&&(ne=ne.slice(0,ie)),ne}function fromArrayLike(ne,ee){var te=ee.length<0?0:checked(ee.length)|0;ne=createBuffer(ne,te);for(var re=0;re<te;re+=1)ne[re]=ee[re]&255;return ne}function fromArrayBuffer(ne,ee,te,re){if(ee.byteLength,te<0||ee.byteLength<te)throw new RangeError("'offset' is out of bounds");if(ee.byteLength<te+(re||0))throw new RangeError("'length' is out of bounds");return te===void 0&&re===void 0?ee=new Uint8Array(ee):re===void 0?ee=new Uint8Array(ee,te):ee=new Uint8Array(ee,te,re),Buffer.TYPED_ARRAY_SUPPORT?(ne=ee,ne.__proto__=Buffer.prototype):ne=fromArrayLike(ne,ee),ne}function fromObject(ne,ee){if(internalIsBuffer(ee)){var te=checked(ee.length)|0;return ne=createBuffer(ne,te),ne.length===0||ee.copy(ne,0,0,te),ne}if(ee){if(typeof ArrayBuffer<"u"&&ee.buffer instanceof ArrayBuffer||"length"in ee)return typeof ee.length!="number"||isnan(ee.length)?createBuffer(ne,0):fromArrayLike(ne,ee);if(ee.type==="Buffer"&&isArray(ee.data))return fromArrayLike(ne,ee.data)}throw new TypeError("First argument must be a string, Buffer, ArrayBuffer, Array, or array-like object.")}function checked(ne){if(ne>=kMaxLength())throw new RangeError("Attempt to allocate Buffer larger than maximum size: 0x"+kMaxLength().toString(16)+" bytes");return ne|0}Buffer.isBuffer=isBuffer;function internalIsBuffer(ne){return!!(ne!=null&&ne._isBuffer)}Buffer.compare=function ne(ee,te){if(!internalIsBuffer(ee)||!internalIsBuffer(te))throw new TypeError("Arguments must be Buffers");if(ee===te)return 0;for(var re=ee.length,ie=te.length,oe=0,se=Math.min(re,ie);oe<se;++oe)if(ee[oe]!==te[oe]){re=ee[oe],ie=te[oe];break}return re<ie?-1:ie<re?1:0};Buffer.isEncoding=function ne(ee){switch(String(ee).toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"latin1":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return!0;default:return!1}};Buffer.concat=function ne(ee,te){if(!isArray(ee))throw new TypeError('"list" argument must be an Array of Buffers');if(ee.length===0)return Buffer.alloc(0);var re;if(te===void 0)for(te=0,re=0;re<ee.length;++re)te+=ee[re].length;var ie=Buffer.allocUnsafe(te),oe=0;for(re=0;re<ee.length;++re){var se=ee[re];if(!internalIsBuffer(se))throw new TypeError('"list" argument must be an Array of Buffers');se.copy(ie,oe),oe+=se.length}return ie};function byteLength(ne,ee){if(internalIsBuffer(ne))return ne.length;if(typeof ArrayBuffer<"u"&&typeof ArrayBuffer.isView=="function"&&(ArrayBuffer.isView(ne)||ne instanceof ArrayBuffer))return ne.byteLength;typeof ne!="string"&&(ne=""+ne);var te=ne.length;if(te===0)return 0;for(var re=!1;;)switch(ee){case"ascii":case"latin1":case"binary":return te;case"utf8":case"utf-8":case void 0:return utf8ToBytes(ne).length;case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return te*2;case"hex":return te>>>1;case"base64":return base64ToBytes(ne).length;default:if(re)return utf8ToBytes(ne).length;ee=(""+ee).toLowerCase(),re=!0}}Buffer.byteLength=byteLength;function slowToString(ne,ee,te){var re=!1;if((ee===void 0||ee<0)&&(ee=0),ee>this.length||((te===void 0||te>this.length)&&(te=this.length),te<=0)||(te>>>=0,ee>>>=0,te<=ee))return"";for(ne||(ne="utf8");;)switch(ne){case"hex":return hexSlice(this,ee,te);case"utf8":case"utf-8":return utf8Slice(this,ee,te);case"ascii":return asciiSlice(this,ee,te);case"latin1":case"binary":return latin1Slice(this,ee,te);case"base64":return base64Slice(this,ee,te);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return utf16leSlice(this,ee,te);default:if(re)throw new TypeError("Unknown encoding: "+ne);ne=(ne+"").toLowerCase(),re=!0}}Buffer.prototype._isBuffer=!0;function swap(ne,ee,te){var re=ne[ee];ne[ee]=ne[te],ne[te]=re}Buffer.prototype.swap16=function ne(){var ee=this.length;if(ee%2!==0)throw new RangeError("Buffer size must be a multiple of 16-bits");for(var te=0;te<ee;te+=2)swap(this,te,te+1);return this};Buffer.prototype.swap32=function ne(){var ee=this.length;if(ee%4!==0)throw new RangeError("Buffer size must be a multiple of 32-bits");for(var te=0;te<ee;te+=4)swap(this,te,te+3),swap(this,te+1,te+2);return this};Buffer.prototype.swap64=function ne(){var ee=this.length;if(ee%8!==0)throw new RangeError("Buffer size must be a multiple of 64-bits");for(var te=0;te<ee;te+=8)swap(this,te,te+7),swap(this,te+1,te+6),swap(this,te+2,te+5),swap(this,te+3,te+4);return this};Buffer.prototype.toString=function ne(){var ee=this.length|0;return ee===0?"":arguments.length===0?utf8Slice(this,0,ee):slowToString.apply(this,arguments)};Buffer.prototype.equals=function ne(ee){if(!internalIsBuffer(ee))throw new TypeError("Argument must be a Buffer");return this===ee?!0:Buffer.compare(this,ee)===0};Buffer.prototype.inspect=function ne(){var ee="",te=INSPECT_MAX_BYTES;return this.length>0&&(ee=this.toString("hex",0,te).match(/.{2}/g).join(" "),this.length>te&&(ee+=" ... ")),"<Buffer "+ee+">"};Buffer.prototype.compare=function ne(ee,te,re,ie,oe){if(!internalIsBuffer(ee))throw new TypeError("Argument must be a Buffer");if(te===void 0&&(te=0),re===void 0&&(re=ee?ee.length:0),ie===void 0&&(ie=0),oe===void 0&&(oe=this.length),te<0||re>ee.length||ie<0||oe>this.length)throw new RangeError("out of range index");if(ie>=oe&&te>=re)return 0;if(ie>=oe)return-1;if(te>=re)return 1;if(te>>>=0,re>>>=0,ie>>>=0,oe>>>=0,this===ee)return 0;for(var se=oe-ie,ae=re-te,ce=Math.min(se,ae),ue=this.slice(ie,oe),fe=ee.slice(te,re),he=0;he<ce;++he)if(ue[he]!==fe[he]){se=ue[he],ae=fe[he];break}return se<ae?-1:ae<se?1:0};function bidirectionalIndexOf(ne,ee,te,re,ie){if(ne.length===0)return-1;if(typeof te=="string"?(re=te,te=0):te>2147483647?te=2147483647:te<-2147483648&&(te=-2147483648),te=+te,isNaN(te)&&(te=ie?0:ne.length-1),te<0&&(te=ne.length+te),te>=ne.length){if(ie)return-1;te=ne.length-1}else if(te<0)if(ie)te=0;else return-1;if(typeof ee=="string"&&(ee=Buffer.from(ee,re)),internalIsBuffer(ee))return ee.length===0?-1:arrayIndexOf(ne,ee,te,re,ie);if(typeof ee=="number")return ee=ee&255,Buffer.TYPED_ARRAY_SUPPORT&&typeof Uint8Array.prototype.indexOf=="function"?ie?Uint8Array.prototype.indexOf.call(ne,ee,te):Uint8Array.prototype.lastIndexOf.call(ne,ee,te):arrayIndexOf(ne,[ee],te,re,ie);throw new TypeError("val must be string, number or Buffer")}function arrayIndexOf(ne,ee,te,re,ie){var oe=1,se=ne.length,ae=ee.length;if(re!==void 0&&(re=String(re).toLowerCase(),re==="ucs2"||re==="ucs-2"||re==="utf16le"||re==="utf-16le")){if(ne.length<2||ee.length<2)return-1;oe=2,se/=2,ae/=2,te/=2}function ce(de,pe){return oe===1?de[pe]:de.readUInt16BE(pe*oe)}var ue;if(ie){var fe=-1;for(ue=te;ue<se;ue++)if(ce(ne,ue)===ce(ee,fe===-1?0:ue-fe)){if(fe===-1&&(fe=ue),ue-fe+1===ae)return fe*oe}else fe!==-1&&(ue-=ue-fe),fe=-1}else for(te+ae>se&&(te=se-ae),ue=te;ue>=0;ue--){for(var he=!0,le=0;le<ae;le++)if(ce(ne,ue+le)!==ce(ee,le)){he=!1;break}if(he)return ue}return-1}Buffer.prototype.includes=function ne(ee,te,re){return this.indexOf(ee,te,re)!==-1};Buffer.prototype.indexOf=function ne(ee,te,re){return bidirectionalIndexOf(this,ee,te,re,!0)};Buffer.prototype.lastIndexOf=function ne(ee,te,re){return bidirectionalIndexOf(this,ee,te,re,!1)};function hexWrite(ne,ee,te,re){te=Number(te)||0;var ie=ne.length-te;re?(re=Number(re),re>ie&&(re=ie)):re=ie;var oe=ee.length;if(oe%2!==0)throw new TypeError("Invalid hex string");re>oe/2&&(re=oe/2);for(var se=0;se<re;++se){var ae=parseInt(ee.substr(se*2,2),16);if(isNaN(ae))return se;ne[te+se]=ae}return se}function utf8Write(ne,ee,te,re){return blitBuffer(utf8ToBytes(ee,ne.length-te),ne,te,re)}function asciiWrite(ne,ee,te,re){return blitBuffer(asciiToBytes(ee),ne,te,re)}function latin1Write(ne,ee,te,re){return asciiWrite(ne,ee,te,re)}function base64Write(ne,ee,te,re){return blitBuffer(base64ToBytes(ee),ne,te,re)}function ucs2Write(ne,ee,te,re){return blitBuffer(utf16leToBytes(ee,ne.length-te),ne,te,re)}Buffer.prototype.write=function ne(ee,te,re,ie){if(te===void 0)ie="utf8",re=this.length,te=0;else if(re===void 0&&typeof te=="string")ie=te,re=this.length,te=0;else if(isFinite(te))te=te|0,isFinite(re)?(re=re|0,ie===void 0&&(ie="utf8")):(ie=re,re=void 0);else throw new Error("Buffer.write(string, encoding, offset[, length]) is no longer supported");var oe=this.length-te;if((re===void 0||re>oe)&&(re=oe),ee.length>0&&(re<0||te<0)||te>this.length)throw new RangeError("Attempt to write outside buffer bounds");ie||(ie="utf8");for(var se=!1;;)switch(ie){case"hex":return hexWrite(this,ee,te,re);case"utf8":case"utf-8":return utf8Write(this,ee,te,re);case"ascii":return asciiWrite(this,ee,te,re);case"latin1":case"binary":return latin1Write(this,ee,te,re);case"base64":return base64Write(this,ee,te,re);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return ucs2Write(this,ee,te,re);default:if(se)throw new TypeError("Unknown encoding: "+ie);ie=(""+ie).toLowerCase(),se=!0}};Buffer.prototype.toJSON=function ne(){return{type:"Buffer",data:Array.prototype.slice.call(this._arr||this,0)}};function base64Slice(ne,ee,te){return ee===0&&te===ne.length?fromByteArray(ne):fromByteArray(ne.slice(ee,te))}function utf8Slice(ne,ee,te){te=Math.min(ne.length,te);for(var re=[],ie=ee;ie<te;){var oe=ne[ie],se=null,ae=oe>239?4:oe>223?3:oe>191?2:1;if(ie+ae<=te){var ce,ue,fe,he;switch(ae){case 1:oe<128&&(se=oe);break;case 2:ce=ne[ie+1],(ce&192)===128&&(he=(oe&31)<<6|ce&63,he>127&&(se=he));break;case 3:ce=ne[ie+1],ue=ne[ie+2],(ce&192)===128&&(ue&192)===128&&(he=(oe&15)<<12|(ce&63)<<6|ue&63,he>2047&&(he<55296||he>57343)&&(se=he));break;case 4:ce=ne[ie+1],ue=ne[ie+2],fe=ne[ie+3],(ce&192)===128&&(ue&192)===128&&(fe&192)===128&&(he=(oe&15)<<18|(ce&63)<<12|(ue&63)<<6|fe&63,he>65535&&he<1114112&&(se=he))}}se===null?(se=65533,ae=1):se>65535&&(se-=65536,re.push(se>>>10&1023|55296),se=56320|se&1023),re.push(se),ie+=ae}return decodeCodePointsArray(re)}var MAX_ARGUMENTS_LENGTH=4096;function decodeCodePointsArray(ne){var ee=ne.length;if(ee<=MAX_ARGUMENTS_LENGTH)return String.fromCharCode.apply(String,ne);for(var te="",re=0;re<ee;)te+=String.fromCharCode.apply(String,ne.slice(re,re+=MAX_ARGUMENTS_LENGTH));return te}function asciiSlice(ne,ee,te){var re="";te=Math.min(ne.length,te);for(var ie=ee;ie<te;++ie)re+=String.fromCharCode(ne[ie]&127);return re}function latin1Slice(ne,ee,te){var re="";te=Math.min(ne.length,te);for(var ie=ee;ie<te;++ie)re+=String.fromCharCode(ne[ie]);return re}function hexSlice(ne,ee,te){var re=ne.length;(!ee||ee<0)&&(ee=0),(!te||te<0||te>re)&&(te=re);for(var ie="",oe=ee;oe<te;++oe)ie+=toHex(ne[oe]);return ie}function utf16leSlice(ne,ee,te){for(var re=ne.slice(ee,te),ie="",oe=0;oe<re.length;oe+=2)ie+=String.fromCharCode(re[oe]+re[oe+1]*256);return ie}Buffer.prototype.slice=function ne(ee,te){var re=this.length;ee=~~ee,te=te===void 0?re:~~te,ee<0?(ee+=re,ee<0&&(ee=0)):ee>re&&(ee=re),te<0?(te+=re,te<0&&(te=0)):te>re&&(te=re),te<ee&&(te=ee);var ie;if(Buffer.TYPED_ARRAY_SUPPORT)ie=this.subarray(ee,te),ie.__proto__=Buffer.prototype;else{var oe=te-ee;ie=new Buffer(oe,void 0);for(var se=0;se<oe;++se)ie[se]=this[se+ee]}return ie};function checkOffset(ne,ee,te){if(ne%1!==0||ne<0)throw new RangeError("offset is not uint");if(ne+ee>te)throw new RangeError("Trying to access beyond buffer length")}Buffer.prototype.readUIntLE=function ne(ee,te,re){ee=ee|0,te=te|0,re||checkOffset(ee,te,this.length);for(var ie=this[ee],oe=1,se=0;++se<te&&(oe*=256);)ie+=this[ee+se]*oe;return ie};Buffer.prototype.readUIntBE=function ne(ee,te,re){ee=ee|0,te=te|0,re||checkOffset(ee,te,this.length);for(var ie=this[ee+--te],oe=1;te>0&&(oe*=256);)ie+=this[ee+--te]*oe;return ie};Buffer.prototype.readUInt8=function ne(ee,te){return te||checkOffset(ee,1,this.length),this[ee]};Buffer.prototype.readUInt16LE=function ne(ee,te){return te||checkOffset(ee,2,this.length),this[ee]|this[ee+1]<<8};Buffer.prototype.readUInt16BE=function ne(ee,te){return te||checkOffset(ee,2,this.length),this[ee]<<8|this[ee+1]};Buffer.prototype.readUInt32LE=function ne(ee,te){return te||checkOffset(ee,4,this.length),(this[ee]|this[ee+1]<<8|this[ee+2]<<16)+this[ee+3]*16777216};Buffer.prototype.readUInt32BE=function ne(ee,te){return te||checkOffset(ee,4,this.length),this[ee]*16777216+(this[ee+1]<<16|this[ee+2]<<8|this[ee+3])};Buffer.prototype.readIntLE=function ne(ee,te,re){ee=ee|0,te=te|0,re||checkOffset(ee,te,this.length);for(var ie=this[ee],oe=1,se=0;++se<te&&(oe*=256);)ie+=this[ee+se]*oe;return oe*=128,ie>=oe&&(ie-=Math.pow(2,8*te)),ie};Buffer.prototype.readIntBE=function ne(ee,te,re){ee=ee|0,te=te|0,re||checkOffset(ee,te,this.length);for(var ie=te,oe=1,se=this[ee+--ie];ie>0&&(oe*=256);)se+=this[ee+--ie]*oe;return oe*=128,se>=oe&&(se-=Math.pow(2,8*te)),se};Buffer.prototype.readInt8=function ne(ee,te){return te||checkOffset(ee,1,this.length),this[ee]&128?(255-this[ee]+1)*-1:this[ee]};Buffer.prototype.readInt16LE=function ne(ee,te){te||checkOffset(ee,2,this.length);var re=this[ee]|this[ee+1]<<8;return re&32768?re|4294901760:re};Buffer.prototype.readInt16BE=function ne(ee,te){te||checkOffset(ee,2,this.length);var re=this[ee+1]|this[ee]<<8;return re&32768?re|4294901760:re};Buffer.prototype.readInt32LE=function ne(ee,te){return te||checkOffset(ee,4,this.length),this[ee]|this[ee+1]<<8|this[ee+2]<<16|this[ee+3]<<24};Buffer.prototype.readInt32BE=function ne(ee,te){return te||checkOffset(ee,4,this.length),this[ee]<<24|this[ee+1]<<16|this[ee+2]<<8|this[ee+3]};Buffer.prototype.readFloatLE=function ne(ee,te){return te||checkOffset(ee,4,this.length),read(this,ee,!0,23,4)};Buffer.prototype.readFloatBE=function ne(ee,te){return te||checkOffset(ee,4,this.length),read(this,ee,!1,23,4)};Buffer.prototype.readDoubleLE=function ne(ee,te){return te||checkOffset(ee,8,this.length),read(this,ee,!0,52,8)};Buffer.prototype.readDoubleBE=function ne(ee,te){return te||checkOffset(ee,8,this.length),read(this,ee,!1,52,8)};function checkInt(ne,ee,te,re,ie,oe){if(!internalIsBuffer(ne))throw new TypeError('"buffer" argument must be a Buffer instance');if(ee>ie||ee<oe)throw new RangeError('"value" argument is out of bounds');if(te+re>ne.length)throw new RangeError("Index out of range")}Buffer.prototype.writeUIntLE=function ne(ee,te,re,ie){if(ee=+ee,te=te|0,re=re|0,!ie){var oe=Math.pow(2,8*re)-1;checkInt(this,ee,te,re,oe,0)}var se=1,ae=0;for(this[te]=ee&255;++ae<re&&(se*=256);)this[te+ae]=ee/se&255;return te+re};Buffer.prototype.writeUIntBE=function ne(ee,te,re,ie){if(ee=+ee,te=te|0,re=re|0,!ie){var oe=Math.pow(2,8*re)-1;checkInt(this,ee,te,re,oe,0)}var se=re-1,ae=1;for(this[te+se]=ee&255;--se>=0&&(ae*=256);)this[te+se]=ee/ae&255;return te+re};Buffer.prototype.writeUInt8=function ne(ee,te,re){return ee=+ee,te=te|0,re||checkInt(this,ee,te,1,255,0),Buffer.TYPED_ARRAY_SUPPORT||(ee=Math.floor(ee)),this[te]=ee&255,te+1};function objectWriteUInt16(ne,ee,te,re){ee<0&&(ee=65535+ee+1);for(var ie=0,oe=Math.min(ne.length-te,2);ie<oe;++ie)ne[te+ie]=(ee&255<<8*(re?ie:1-ie))>>>(re?ie:1-ie)*8}Buffer.prototype.writeUInt16LE=function ne(ee,te,re){return ee=+ee,te=te|0,re||checkInt(this,ee,te,2,65535,0),Buffer.TYPED_ARRAY_SUPPORT?(this[te]=ee&255,this[te+1]=ee>>>8):objectWriteUInt16(this,ee,te,!0),te+2};Buffer.prototype.writeUInt16BE=function ne(ee,te,re){return ee=+ee,te=te|0,re||checkInt(this,ee,te,2,65535,0),Buffer.TYPED_ARRAY_SUPPORT?(this[te]=ee>>>8,this[te+1]=ee&255):objectWriteUInt16(this,ee,te,!1),te+2};function objectWriteUInt32(ne,ee,te,re){ee<0&&(ee=4294967295+ee+1);for(var ie=0,oe=Math.min(ne.length-te,4);ie<oe;++ie)ne[te+ie]=ee>>>(re?ie:3-ie)*8&255}Buffer.prototype.writeUInt32LE=function ne(ee,te,re){return ee=+ee,te=te|0,re||checkInt(this,ee,te,4,4294967295,0),Buffer.TYPED_ARRAY_SUPPORT?(this[te+3]=ee>>>24,this[te+2]=ee>>>16,this[te+1]=ee>>>8,this[te]=ee&255):objectWriteUInt32(this,ee,te,!0),te+4};Buffer.prototype.writeUInt32BE=function ne(ee,te,re){return ee=+ee,te=te|0,re||checkInt(this,ee,te,4,4294967295,0),Buffer.TYPED_ARRAY_SUPPORT?(this[te]=ee>>>24,this[te+1]=ee>>>16,this[te+2]=ee>>>8,this[te+3]=ee&255):objectWriteUInt32(this,ee,te,!1),te+4};Buffer.prototype.writeIntLE=function ne(ee,te,re,ie){if(ee=+ee,te=te|0,!ie){var oe=Math.pow(2,8*re-1);checkInt(this,ee,te,re,oe-1,-oe)}var se=0,ae=1,ce=0;for(this[te]=ee&255;++se<re&&(ae*=256);)ee<0&&ce===0&&this[te+se-1]!==0&&(ce=1),this[te+se]=(ee/ae>>0)-ce&255;return te+re};Buffer.prototype.writeIntBE=function ne(ee,te,re,ie){if(ee=+ee,te=te|0,!ie){var oe=Math.pow(2,8*re-1);checkInt(this,ee,te,re,oe-1,-oe)}var se=re-1,ae=1,ce=0;for(this[te+se]=ee&255;--se>=0&&(ae*=256);)ee<0&&ce===0&&this[te+se+1]!==0&&(ce=1),this[te+se]=(ee/ae>>0)-ce&255;return te+re};Buffer.prototype.writeInt8=function ne(ee,te,re){return ee=+ee,te=te|0,re||checkInt(this,ee,te,1,127,-128),Buffer.TYPED_ARRAY_SUPPORT||(ee=Math.floor(ee)),ee<0&&(ee=255+ee+1),this[te]=ee&255,te+1};Buffer.prototype.writeInt16LE=function ne(ee,te,re){return ee=+ee,te=te|0,re||checkInt(this,ee,te,2,32767,-32768),Buffer.TYPED_ARRAY_SUPPORT?(this[te]=ee&255,this[te+1]=ee>>>8):objectWriteUInt16(this,ee,te,!0),te+2};Buffer.prototype.writeInt16BE=function ne(ee,te,re){return ee=+ee,te=te|0,re||checkInt(this,ee,te,2,32767,-32768),Buffer.TYPED_ARRAY_SUPPORT?(this[te]=ee>>>8,this[te+1]=ee&255):objectWriteUInt16(this,ee,te,!1),te+2};Buffer.prototype.writeInt32LE=function ne(ee,te,re){return ee=+ee,te=te|0,re||checkInt(this,ee,te,4,2147483647,-2147483648),Buffer.TYPED_ARRAY_SUPPORT?(this[te]=ee&255,this[te+1]=ee>>>8,this[te+2]=ee>>>16,this[te+3]=ee>>>24):objectWriteUInt32(this,ee,te,!0),te+4};Buffer.prototype.writeInt32BE=function ne(ee,te,re){return ee=+ee,te=te|0,re||checkInt(this,ee,te,4,2147483647,-2147483648),ee<0&&(ee=4294967295+ee+1),Buffer.TYPED_ARRAY_SUPPORT?(this[te]=ee>>>24,this[te+1]=ee>>>16,this[te+2]=ee>>>8,this[te+3]=ee&255):objectWriteUInt32(this,ee,te,!1),te+4};function checkIEEE754(ne,ee,te,re,ie,oe){if(te+re>ne.length)throw new RangeError("Index out of range");if(te<0)throw new RangeError("Index out of range")}function writeFloat(ne,ee,te,re,ie){return ie||checkIEEE754(ne,ee,te,4),write(ne,ee,te,re,23,4),te+4}Buffer.prototype.writeFloatLE=function ne(ee,te,re){return writeFloat(this,ee,te,!0,re)};Buffer.prototype.writeFloatBE=function ne(ee,te,re){return writeFloat(this,ee,te,!1,re)};function writeDouble(ne,ee,te,re,ie){return ie||checkIEEE754(ne,ee,te,8),write(ne,ee,te,re,52,8),te+8}Buffer.prototype.writeDoubleLE=function ne(ee,te,re){return writeDouble(this,ee,te,!0,re)};Buffer.prototype.writeDoubleBE=function ne(ee,te,re){return writeDouble(this,ee,te,!1,re)};Buffer.prototype.copy=function ne(ee,te,re,ie){if(re||(re=0),!ie&&ie!==0&&(ie=this.length),te>=ee.length&&(te=ee.length),te||(te=0),ie>0&&ie<re&&(ie=re),ie===re||ee.length===0||this.length===0)return 0;if(te<0)throw new RangeError("targetStart out of bounds");if(re<0||re>=this.length)throw new RangeError("sourceStart out of bounds");if(ie<0)throw new RangeError("sourceEnd out of bounds");ie>this.length&&(ie=this.length),ee.length-te<ie-re&&(ie=ee.length-te+re);var oe=ie-re,se;if(this===ee&&re<te&&te<ie)for(se=oe-1;se>=0;--se)ee[se+te]=this[se+re];else if(oe<1e3||!Buffer.TYPED_ARRAY_SUPPORT)for(se=0;se<oe;++se)ee[se+te]=this[se+re];else Uint8Array.prototype.set.call(ee,this.subarray(re,re+oe),te);return oe};Buffer.prototype.fill=function ne(ee,te,re,ie){if(typeof ee=="string"){if(typeof te=="string"?(ie=te,te=0,re=this.length):typeof re=="string"&&(ie=re,re=this.length),ee.length===1){var oe=ee.charCodeAt(0);oe<256&&(ee=oe)}if(ie!==void 0&&typeof ie!="string")throw new TypeError("encoding must be a string");if(typeof ie=="string"&&!Buffer.isEncoding(ie))throw new TypeError("Unknown encoding: "+ie)}else typeof ee=="number"&&(ee=ee&255);if(te<0||this.length<te||this.length<re)throw new RangeError("Out of range index");if(re<=te)return this;te=te>>>0,re=re===void 0?this.length:re>>>0,ee||(ee=0);var se;if(typeof ee=="number")for(se=te;se<re;++se)this[se]=ee;else{var ae=internalIsBuffer(ee)?ee:utf8ToBytes(new Buffer(ee,ie).toString()),ce=ae.length;for(se=0;se<re-te;++se)this[se+te]=ae[se%ce]}return this};var INVALID_BASE64_RE=/[^+\/0-9A-Za-z-_]/g;function base64clean(ne){if(ne=stringtrim(ne).replace(INVALID_BASE64_RE,""),ne.length<2)return"";for(;ne.length%4!==0;)ne=ne+"=";return ne}function stringtrim(ne){return ne.trim?ne.trim():ne.replace(/^\s+|\s+$/g,"")}function toHex(ne){return ne<16?"0"+ne.toString(16):ne.toString(16)}function utf8ToBytes(ne,ee){ee=ee||1/0;for(var te,re=ne.length,ie=null,oe=[],se=0;se<re;++se){if(te=ne.charCodeAt(se),te>55295&&te<57344){if(!ie){if(te>56319){(ee-=3)>-1&&oe.push(239,191,189);continue}else if(se+1===re){(ee-=3)>-1&&oe.push(239,191,189);continue}ie=te;continue}if(te<56320){(ee-=3)>-1&&oe.push(239,191,189),ie=te;continue}te=(ie-55296<<10|te-56320)+65536}else ie&&(ee-=3)>-1&&oe.push(239,191,189);if(ie=null,te<128){if((ee-=1)<0)break;oe.push(te)}else if(te<2048){if((ee-=2)<0)break;oe.push(te>>6|192,te&63|128)}else if(te<65536){if((ee-=3)<0)break;oe.push(te>>12|224,te>>6&63|128,te&63|128)}else if(te<1114112){if((ee-=4)<0)break;oe.push(te>>18|240,te>>12&63|128,te>>6&63|128,te&63|128)}else throw new Error("Invalid code point")}return oe}function asciiToBytes(ne){for(var ee=[],te=0;te<ne.length;++te)ee.push(ne.charCodeAt(te)&255);return ee}function utf16leToBytes(ne,ee){for(var te,re,ie,oe=[],se=0;se<ne.length&&!((ee-=2)<0);++se)te=ne.charCodeAt(se),re=te>>8,ie=te%256,oe.push(ie),oe.push(re);return oe}function base64ToBytes(ne){return toByteArray(base64clean(ne))}function blitBuffer(ne,ee,te,re){for(var ie=0;ie<re&&!(ie+te>=ee.length||ie>=ne.length);++ie)ee[ie+te]=ne[ie];return ie}function isnan(ne){return ne!==ne}function isBuffer(ne){return ne!=null&&(!!ne._isBuffer||isFastBuffer(ne)||isSlowBuffer(ne))}function isFastBuffer(ne){return!!ne.constructor&&typeof ne.constructor.isBuffer=="function"&&ne.constructor.isBuffer(ne)}function isSlowBuffer(ne){return typeof ne.readFloatLE=="function"&&typeof ne.slice=="function"&&isFastBuffer(ne.slice(0,0))}var commonjsGlobal=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function encrypt(ne,ee){const te=generateSalt();return keyFromPassword(ne,te).then(function(re){return encryptWithKey(re,ee)}).then(function(re){return re.salt=te,JSON.stringify(re)})}function encryptWithKey(ne,ee){const te=JSON.stringify(ee),re=Buffer.from(te,"utf-8"),ie=commonjsGlobal.crypto.getRandomValues(new Uint8Array(16));return commonjsGlobal.crypto.subtle.encrypt({name:"AES-GCM",iv:ie},ne,re).then(function(oe){const se=new Uint8Array(oe),ae=Buffer.from(ie).toString("base64");return{data:Buffer.from(se).toString("base64"),iv:ae}})}function decrypt(ne,ee){const te=JSON.parse(ee),{salt:re}=te;return keyFromPassword(ne,re).then(function(ie){return decryptWithKey(ie,te)})}function decryptWithKey(ne,ee){const te=Buffer.from(ee.data,"base64"),re=Buffer.from(ee.iv,"base64");return crypto.subtle.decrypt({name:"AES-GCM",iv:re},ne,te).then(function(ie){const oe=new Uint8Array(ie),se=Buffer.from(oe).toString("utf-8");return JSON.parse(se)}).catch(function(ie){throw new Error("Incorrect password")})}function keyFromPassword(ne,ee){const te=Buffer.from(ne,"utf-8"),re=Buffer.from(ee,"base64");return commonjsGlobal.crypto.subtle.importKey("raw",te,{name:"PBKDF2"},!1,["deriveBits","deriveKey"]).then(function(ie){return commonjsGlobal.crypto.subtle.deriveKey({name:"PBKDF2",salt:re,iterations:1e4,hash:"SHA-256"},ie,{name:"AES-GCM",length:256},!1,["encrypt","decrypt"])})}function serializeBufferFromStorage(ne){const ee=ne.slice(0,2)==="0x"?ne.slice(2):ne,te=new Uint8Array(ee.length/2);for(let re=0;re<ee.length;re+=2){const ie=ee.substr(re,2);te[re/2]=parseInt(ie,16)}return te}function serializeBufferForStorage(ne){let ee="0x";const te=ne.length||ne.byteLength;for(let re=0;re<te;re++)ee+=unprefixedHex(ne[re]);return ee}function unprefixedHex(ne){let ee=ne.toString(16);for(;ee.length<2;)ee=`0${ee}`;return ee}function generateSalt(ne=32){const ee=new Uint8Array(ne);return commonjsGlobal.crypto.getRandomValues(ee),btoa(String.fromCharCode.apply(null,ee))}var dist={encrypt,decrypt,keyFromPassword,encryptWithKey,decryptWithKey,serializeBufferForStorage,serializeBufferFromStorage,generateSalt};async function encryptData(ne,ee){return await dist.encrypt(ne,ee)}console.log("hello123123");async function decryptData(ne,ee){return await dist.decrypt(ne,ee)}class TemplateStorage{}var RemoteStatus=(ne=>(ne.Success="success",ne.Timeout="timeout",ne.Exists="exists",ne.InvalidRoute="invalidroute",ne.InvalidData="invaliddata",ne.NoData="nodata",ne.TooLarge="toolarge",ne))(RemoteStatus||{}),StorageStatus=(ne=>(ne[ne.Success=0]="Success",ne[ne.Error=1]="Error",ne[ne.NoData=2]="NoData",ne[ne.Duplicate=3]="Duplicate",ne[ne.NotFound=4]="NotFound",ne[ne.InvalidData=5]="InvalidData",ne))(StorageStatus||{}),SyncStatus=(ne=>(ne[ne.Success=0]="Success",ne[ne.Error=1]="Error",ne))(SyncStatus||{});const deletedAccountString="deleteddeleteddeleted";class DefaultStorage extends TemplateStorage{async getData(ee){const te=localStorage.getItem("data");return te===null?[StorageStatus.NoData,null]:[StorageStatus.Success,await decryptData(ee,te)]}async setData(ee,te){const re=await encryptData(ee,te);return localStorage.setItem("data",re),StorageStatus.Success}async addAccount(ee,te,re){let[ie,oe]=await this.getData(ee);return ie!==StorageStatus.Success?ie:oe.some(se=>se.key!==deletedAccountString&&se.name===te)?StorageStatus.Duplicate:(oe=oe.filter(se=>!(se.key===deletedAccountString&&se.name===te)),oe.push({name:te,key:re}),await this.setData(ee,oe))}async removeAccount(ee,te){const[re,ie]=await this.getData(ee);if(re!==StorageStatus.Success)return re;const oe=ie.filter(se=>se.name!==te);return await this.setData(ee,oe)}verifyLocalData(){return localStorage.getItem("data")!==null}clearLocalData(){return localStorage.removeItem("data"),StorageStatus.Success}initLocalData(ee){return this.setData(ee,[]),StorageStatus.Success}}class TemplateRemote{}class DefaultRemote extends TemplateRemote{constructor(){super(...arguments),this.baseRemoteURL="https://totp.blobbybilb.workers.dev/",this.remoteURLs={get:this.baseRemoteURL+"get/",set:this.baseRemoteURL+"set/",exists:this.baseRemoteURL+"exists/"}}async checkIfExists(){try{await fetch(this.remoteURLs.exists)}catch{return!1}return await(await fetch(this.remoteURLs.exists)).text()===RemoteStatus.Exists}async getData(ee,te){const re=await(await fetch(this.remoteURLs.get+ee)).text();if(!re.startsWith(RemoteStatus.Success))return[re,null];const ie=await decryptData(te,re.substring(RemoteStatus.Success.length,re.length));return[RemoteStatus.Success,ie]}async setData(ee,te,re){const ie=await encryptData(te,re);return await(await fetch(this.remoteURLs.set+ee,{method:"POST",body:ie})).text()}}class TemplateSync{}console.log("hello");class DefaultSync extends TemplateSync{constructor(ee,te){super(),this.remote=ee,this.storage=te}async syncData(ee,te,re){let[,ie]=await this.remote.getData(te,re);const[,oe]=await this.storage.getData(ee);ie===null&&(await this.remote.setData(te,re,oe),ie=oe),console.log("localData",oe),console.log("remoteData",ie);const se=[...oe,...ie];console.log("merged",se);const ae=[],ce=se.filter(ue=>ae.includes(ue.name)?!1:(ae.push(ue.name),!0)).filter(ue=>ue.key!==deletedAccountString);return console.log("deduplicated",ce),await this.storage.setData(ee,ce),await this.remote.setData(te,re,ce),[SyncStatus.Success,[RemoteStatus.Success,StorageStatus.Success]]}}const storage=readable(new DefaultStorage),sync=readable(new DefaultSync(new DefaultRemote,new DefaultStorage)),currentName=writable("");var ModalShown=(ne=>(ne[ne.None=0]="None",ne[ne.QRScan=1]="QRScan",ne))(ModalShown||{});const modalShown=writable(0),IconButton_svelte_svelte_type_style_lang="";function create_fragment$7(ne){let ee,te,re,ie,oe;return{c(){ee=element("button"),te=element("img"),src_url_equal(te.src,re=ne[0])||attr(te,"src",re),attr(te,"alt",ne[1]),set_style(te,"height",ne[3]+"px"),attr(te,"class","svelte-1qa37wb"),attr(ee,"class","svelte-1qa37wb")},m(se,ae){insert(se,ee,ae),append(ee,te),ie||(oe=listen(ee,"click",function(){is_function(ne[2])&&ne[2].apply(this,arguments)}),ie=!0)},p(se,[ae]){ne=se,ae&1&&!src_url_equal(te.src,re=ne[0])&&attr(te,"src",re),ae&2&&attr(te,"alt",ne[1]),ae&8&&set_style(te,"height",ne[3]+"px")},i:noop,o:noop,d(se){se&&detach(ee),ie=!1,oe()}}}function instance$7(ne,ee,te){let{src:re}=ee,{alt:ie}=ee,{action:oe}=ee,{size:se=23}=ee;return ne.$$set=ae=>{"src"in ae&&te(0,re=ae.src),"alt"in ae&&te(1,ie=ae.alt),"action"in ae&&te(2,oe=ae.action),"size"in ae&&te(3,se=ae.size)},[re,ie,oe,se]}class IconButton extends SvelteComponent{constructor(ee){super(),init$1(this,ee,instance$7,create_fragment$7,safe_not_equal,{src:0,alt:1,action:2,size:3})}}const Titlebar_svelte_svelte_type_style_lang="";function create_fragment$6(ne){let ee,te,re,ie,oe,se,ae,ce;return re=new IconButton({props:{action:ne[1],src:syncIcon,alt:"sync"}}),ae=new IconButton({props:{action:ne[0],src:settingsIcon,alt:"settings"}}),{c(){ee=element("main"),te=element("div"),create_component(re.$$.fragment),ie=space(),oe=element("p"),oe.textContent="TOTP[App]",se=space(),create_component(ae.$$.fragment),attr(oe,"class","svelte-19hef0g"),attr(te,"id","grid"),attr(te,"class","svelte-19hef0g"),attr(ee,"class","svelte-19hef0g")},m(ue,fe){insert(ue,ee,fe),append(ee,te),mount_component(re,te,null),append(te,ie),append(te,oe),append(te,se),mount_component(ae,te,null),ce=!0},p:noop,i(ue){ce||(transition_in(re.$$.fragment,ue),transition_in(ae.$$.fragment,ue),ce=!0)},o(ue){transition_out(re.$$.fragment,ue),transition_out(ae.$$.fragment,ue),ce=!1},d(ue){ue&&detach(ee),destroy_component(re),destroy_component(ae)}}}function instance$6(ne,ee,te){let re;component_subscribe(ne,sync,ae=>te(3,re=ae));let{PIN:ie}=ee;function oe(){var ce;const ae=prompt("Enter an existing sync token or use the randomly generated one.",(ce=localStorage.getItem("remoteToken"))!=null?ce:randomSecret());ae&&localStorage.setItem("remoteToken",ae)}function se(){var ce;let ae=prompt("Enter your sync encryption password.",(ce=localStorage.getItem("remotePassword"))!=null?ce:"");ae!==null&&(localStorage.setItem("remotePassword",ae),re.syncData(ie,localStorage.getItem("remoteToken"),ae).then(window.location.reload.bind(window.location)))}return ne.$$set=ae=>{"PIN"in ae&&te(2,ie=ae.PIN)},[oe,se,ie]}class Titlebar extends SvelteComponent{constructor(ee){super(),init$1(this,ee,instance$6,create_fragment$6,safe_not_equal,{PIN:2})}}const copyIcon="/assets/copy-outline.dcb3880e.svg",Totpdisplay_svelte_svelte_type_style_lang="";function create_fragment$5(ne){let ee,te,re,ie,oe,se,ae,ce,ue,fe,he,le;return ce=new IconButton({props:{action:ne[3],src:copyIcon,alt:"copy",size:25}}),{c(){ee=element("div"),te=element("p"),re=text(ne[2]),ie=space(),oe=element("p"),se=text(ne[0]),ae=space(),create_component(ce.$$.fragment),ue=space(),fe=element("p"),he=text(ne[1]),attr(te,"id","account"),attr(te,"class","svelte-yamkn2"),attr(oe,"id","otp"),attr(oe,"class","svelte-yamkn2"),attr(fe,"id","timer"),attr(fe,"class","svelte-yamkn2"),attr(ee,"class","svelte-yamkn2")},m(de,pe){insert(de,ee,pe),append(ee,te),append(te,re),append(ee,ie),append(ee,oe),append(oe,se),append(ee,ae),mount_component(ce,ee,null),append(ee,ue),append(ee,fe),append(fe,he),le=!0},p(de,[pe]){(!le||pe&4)&&set_data(re,de[2]),(!le||pe&1)&&set_data(se,de[0]),(!le||pe&2)&&set_data(he,de[1])},i(de){le||(transition_in(ce.$$.fragment,de),le=!0)},o(de){transition_out(ce.$$.fragment,de),le=!1},d(de){de&&detach(ee),destroy_component(ce)}}}function instance$5(ne,ee,te){let re="123 123",ie=0,oe="-",se;function ae(fe){se=newTOTP(fe.key),te(2,oe=fe.name),ce()}function ce(){if(!se)return;const fe=se.generate();te(0,re=`${fe.substring(0,3)} ${fe.substring(3,6)}`),te(1,ie=getTimeUntilTOTPChange()),currentName.set(oe)}function ue(){navigator.clipboard.writeText(re.replace(" ",""))}return setInterval(ce,1e3),[re,ie,oe,ue,ae]}class Totpdisplay extends SvelteComponent{constructor(ee){super(),init$1(this,ee,instance$5,create_fragment$5,safe_not_equal,{set:4})}get set(){return this.$$.ctx[4]}}const qrIcon="/assets/qr-code-outline.6d1800dd.svg",plusIcon="/assets/add-outline.fa372d22.svg",trashIcon="/assets/trash-outline.28058320.svg",editIcon="/assets/create-outline.b68008ae.svg",Topbar_svelte_svelte_type_style_lang="";function create_fragment$4(ne){let ee,te,re,ie,oe,se,ae,ce,ue;return te=new IconButton({props:{action:ne[5],src:qrIcon,alt:"scan"}}),ie=new IconButton({props:{action:ne[1],src:plusIcon,alt:"add"}}),se=new IconButton({props:{action:ne[2],src:trashIcon,alt:"delete"}}),ce=new IconButton({props:{action:ne[3],src:editIcon,alt:"edit"}}),{c(){ee=element("div"),create_component(te.$$.fragment),re=space(),create_component(ie.$$.fragment),oe=space(),create_component(se.$$.fragment),ae=space(),create_component(ce.$$.fragment),attr(ee,"class","svelte-kbpegu")},m(fe,he){insert(fe,ee,he),mount_component(te,ee,null),append(ee,re),mount_component(ie,ee,null),append(ee,oe),mount_component(se,ee,null),append(ee,ae),mount_component(ce,ee,null),ue=!0},p(fe,[he]){const le={};he&1&&(le.action=fe[5]),te.$set(le)},i(fe){ue||(transition_in(te.$$.fragment,fe),transition_in(ie.$$.fragment,fe),transition_in(se.$$.fragment,fe),transition_in(ce.$$.fragment,fe),ue=!0)},o(fe){transition_out(te.$$.fragment,fe),transition_out(ie.$$.fragment,fe),transition_out(se.$$.fragment,fe),transition_out(ce.$$.fragment,fe),ue=!1},d(fe){fe&&detach(ee),destroy_component(te),destroy_component(ie),destroy_component(se),destroy_component(ce)}}}function instance$4(ne,ee,te){let re,ie,oe;component_subscribe(ne,currentName,he=>te(6,re=he)),component_subscribe(ne,storage,he=>te(7,ie=he)),component_subscribe(ne,modalShown,he=>te(0,oe=he));let{PIN:se}=ee;function ae(){const he=prompt("Enter account name");if(!he)return;const le=prompt("Enter account key");!le||(ie.addAccount(se,he,le),window.location.reload())}async function ce(){confirm("Delete selected account?")&&(await ie.removeAccount(se,re),await ie.addAccount(se,re,"deleteddeleteddeleted"),window.location.reload())}async function ue(){if(confirm("Edit selected account?")){const he=prompt("Enter new account key");if(!he)return;await ie.removeAccount(se,re),await ie.addAccount(se,re,he),window.location.reload()}}const fe=()=>set_store_value(modalShown,oe=ModalShown.QRScan,oe);return ne.$$set=he=>{"PIN"in he&&te(4,se=he.PIN)},[oe,ae,ce,ue,se,fe]}class Topbar extends SvelteComponent{constructor(ee){super(),init$1(this,ee,instance$4,create_fragment$4,safe_not_equal,{PIN:4})}}const Account_svelte_svelte_type_style_lang="";function create_fragment$3(ne){let ee,te=ne[0].name+"",re,ie,oe,se,ae,ce;return{c(){ee=element("button"),re=text(te),oe=space(),se=element("br"),attr(ee,"id",ne[2]),attr(ee,"class",ie=null_to_empty(ne[1]===ne[0].name?"selected":"")+" svelte-1jfjw9d")},m(ue,fe){insert(ue,ee,fe),append(ee,re),insert(ue,oe,fe),insert(ue,se,fe),ae||(ce=listen(ee,"click",ne[3]),ae=!0)},p(ue,[fe]){fe&1&&te!==(te=ue[0].name+"")&&set_data(re,te),fe&3&&ie!==(ie=null_to_empty(ue[1]===ue[0].name?"selected":"")+" svelte-1jfjw9d")&&attr(ee,"class",ie)},i:noop,o:noop,d(ue){ue&&detach(ee),ue&&detach(oe),ue&&detach(se),ae=!1,ce()}}}function instance$3(ne,ee,te){let re;component_subscribe(ne,currentName,ce=>te(1,re=ce));let{token:ie}=ee,{setTOTPDisplay:oe}=ee;const se=`${ie.name}`;function ae(){oe(ie);const ce=document.getElementById(se);ce.style.opacity="0.75",setTimeout(()=>{ce.style.opacity="1"},100)}return ne.$$set=ce=>{"token"in ce&&te(0,ie=ce.token),"setTOTPDisplay"in ce&&te(4,oe=ce.setTOTPDisplay)},[ie,re,se,ae,oe]}class Account extends SvelteComponent{constructor(ee){super(),init$1(this,ee,instance$3,create_fragment$3,safe_not_equal,{token:0,setTOTPDisplay:4})}}const Container_svelte_svelte_type_style_lang="";function get_each_context(ne,ee,te){const re=ne.slice();return re[5]=ee[te],re}function create_catch_block(ne){return{c:noop,m:noop,p:noop,i:noop,o:noop,d:noop}}function create_then_block(ne){let ee,te,re=ne[4],ie=[];for(let se=0;se<re.length;se+=1)ie[se]=create_each_block(get_each_context(ne,re,se));const oe=se=>transition_out(ie[se],1,1,()=>{ie[se]=null});return{c(){for(let se=0;se<ie.length;se+=1)ie[se].c();ee=empty()},m(se,ae){for(let ce=0;ce<ie.length;ce+=1)ie[ce].m(se,ae);insert(se,ee,ae),te=!0},p(se,ae){if(ae&6){re=se[4];let ce;for(ce=0;ce<re.length;ce+=1){const ue=get_each_context(se,re,ce);ie[ce]?(ie[ce].p(ue,ae),transition_in(ie[ce],1)):(ie[ce]=create_each_block(ue),ie[ce].c(),transition_in(ie[ce],1),ie[ce].m(ee.parentNode,ee))}for(group_outros(),ce=re.length;ce<ie.length;ce+=1)oe(ce);check_outros()}},i(se){if(!te){for(let ae=0;ae<re.length;ae+=1)transition_in(ie[ae]);te=!0}},o(se){ie=ie.filter(Boolean);for(let ae=0;ae<ie.length;ae+=1)transition_out(ie[ae]);te=!1},d(se){destroy_each(ie,se),se&&detach(ee)}}}function create_if_block$1(ne){let ee,te;return ee=new Account({props:{token:ne[5],setTOTPDisplay:ne[1]}}),{c(){create_component(ee.$$.fragment)},m(re,ie){mount_component(ee,re,ie),te=!0},p(re,ie){const oe={};ie&2&&(oe.setTOTPDisplay=re[1]),ee.$set(oe)},i(re){te||(transition_in(ee.$$.fragment,re),te=!0)},o(re){transition_out(ee.$$.fragment,re),te=!1},d(re){destroy_component(ee,re)}}}function create_each_block(ne){let ee,te,re=ne[5].key!==deletedAccountString&&create_if_block$1(ne);return{c(){re&&re.c(),ee=empty()},m(ie,oe){re&&re.m(ie,oe),insert(ie,ee,oe),te=!0},p(ie,oe){ie[5].key!==deletedAccountString&&re.p(ie,oe)},i(ie){te||(transition_in(re),te=!0)},o(ie){transition_out(re),te=!1},d(ie){re&&re.d(ie),ie&&detach(ee)}}}function create_pending_block(ne){return{c:noop,m:noop,p:noop,i:noop,o:noop,d:noop}}function create_fragment$2(ne){let ee,te,re,ie,oe,se,ae;te=new Topbar({props:{PIN:ne[0]}});let ce={ctx:ne,current:null,token:null,hasCatch:!1,pending:create_pending_block,then:create_then_block,catch:create_catch_block,value:4,blocks:[,,,]};return handle_promise(ne[2](),ce),{c(){ee=element("main"),create_component(te.$$.fragment),re=space(),ie=element("div"),ce.block.c(),oe=space(),se=element("div"),attr(se,"id","bottom-padding"),attr(se,"class","svelte-1tpj1j7"),attr(ie,"id","container"),attr(ie,"class","svelte-1tpj1j7"),attr(ee,"class","svelte-1tpj1j7")},m(ue,fe){insert(ue,ee,fe),mount_component(te,ee,null),append(ee,re),append(ee,ie),ce.block.m(ie,ce.anchor=null),ce.mount=()=>ie,ce.anchor=oe,append(ie,oe),append(ie,se),ae=!0},p(ue,[fe]){ne=ue;const he={};fe&1&&(he.PIN=ne[0]),te.$set(he),update_await_block_branch(ce,ne,fe)},i(ue){ae||(transition_in(te.$$.fragment,ue),transition_in(ce.block),ae=!0)},o(ue){transition_out(te.$$.fragment,ue);for(let fe=0;fe<3;fe+=1){const he=ce.blocks[fe];transition_out(he)}ae=!1},d(ue){ue&&detach(ee),destroy_component(te),ce.block.d(),ce.token=null,ce=null}}}function instance$2(ne,ee,te){let re;component_subscribe(ne,storage,ae=>te(3,re=ae));let{PIN:ie}=ee,{setTOTPDisplay:oe}=ee;async function se(){return console.log("DATA",(await re.getData(ie))[1]),(await re.getData(ie))[1]}return ne.$$set=ae=>{"PIN"in ae&&te(0,ie=ae.PIN),"setTOTPDisplay"in ae&&te(1,oe=ae.setTOTPDisplay)},[ie,oe,se]}class Container extends SvelteComponent{constructor(ee){super(),init$1(this,ee,instance$2,create_fragment$2,safe_not_equal,{PIN:0,setTOTPDisplay:1})}}const scriptRel="modulepreload",assetsURL=function(ne){return"/"+ne},seen={},__vitePreload=function ne(ee,te,re){return!te||te.length===0?ee():Promise.all(te.map(ie=>{if(ie=assetsURL(ie),ie in seen)return;seen[ie]=!0;const oe=ie.endsWith(".css"),se=oe?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${ie}"]${se}`))return;const ae=document.createElement("link");if(ae.rel=oe?"stylesheet":scriptRel,oe||(ae.as="script",ae.crossOrigin=""),ae.href=ie,document.head.appendChild(ae),oe)return new Promise((ce,ue)=>{ae.addEventListener("load",ce),ae.addEventListener("error",()=>ue(new Error(`Unable to preload CSS for ${ie}`)))})})).then(()=>ee())};class e{constructor(ee,te,re,ie,oe){this._legacyCanvasSize=e.DEFAULT_CANVAS_SIZE,this._preferredCamera="environment",this._maxScansPerSecond=25,this._lastScanTimestamp=-1,this._destroyed=this._flashOn=this._paused=this._active=!1,this.$video=ee,this.$canvas=document.createElement("canvas"),re&&typeof re=="object"?this._onDecode=te:(console.warn(re||ie||oe?"You're using a deprecated version of the QrScanner constructor which will be removed in the future":"Note that the type of the scan result passed to onDecode will change in the future. To already switch to the new api today, you can pass returnDetailedScanResult: true."),this._legacyOnDecode=te),te=typeof re=="object"?re:{},this._onDecodeError=te.onDecodeError||(typeof re=="function"?re:this._onDecodeError),this._calculateScanRegion=te.calculateScanRegion||(typeof ie=="function"?ie:this._calculateScanRegion),this._preferredCamera=te.preferredCamera||oe||this._preferredCamera,this._legacyCanvasSize=typeof re=="number"?re:typeof ie=="number"?ie:this._legacyCanvasSize,this._maxScansPerSecond=te.maxScansPerSecond||this._maxScansPerSecond,this._onPlay=this._onPlay.bind(this),this._onLoadedMetaData=this._onLoadedMetaData.bind(this),this._onVisibilityChange=this._onVisibilityChange.bind(this),this._updateOverlay=this._updateOverlay.bind(this),ee.disablePictureInPicture=!0,ee.playsInline=!0,ee.muted=!0;let se=!1;if(ee.hidden&&(ee.hidden=!1,se=!0),document.body.contains(ee)||(document.body.appendChild(ee),se=!0),re=ee.parentElement,te.highlightScanRegion||te.highlightCodeOutline){if(ie=!!te.overlay,this.$overlay=te.overlay||document.createElement("div"),oe=this.$overlay.style,oe.position="absolute",oe.display="none",oe.pointerEvents="none",this.$overlay.classList.add("scan-region-highlight"),!ie&&te.highlightScanRegion){this.$overlay.innerHTML='<svg class="scan-region-highlight-svg" viewBox="0 0 238 238" preserveAspectRatio="none" style="position:absolute;width:100%;height:100%;left:0;top:0;fill:none;stroke:#e9b213;stroke-width:4;stroke-linecap:round;stroke-linejoin:round"><path d="M31 2H10a8 8 0 0 0-8 8v21M207 2h21a8 8 0 0 1 8 8v21m0 176v21a8 8 0 0 1-8 8h-21m-176 0H10a8 8 0 0 1-8-8v-21"/></svg>';try{this.$overlay.firstElementChild.animate({transform:["scale(.98)","scale(1.01)"]},{duration:400,iterations:1/0,direction:"alternate",easing:"ease-in-out"})}catch{}re.insertBefore(this.$overlay,this.$video.nextSibling)}te.highlightCodeOutline&&(this.$overlay.insertAdjacentHTML("beforeend",'<svg class="code-outline-highlight" preserveAspectRatio="none" style="display:none;width:100%;height:100%;fill:none;stroke:#e9b213;stroke-width:5;stroke-dasharray:25;stroke-linecap:round;stroke-linejoin:round"><polygon/></svg>'),this.$codeOutlineHighlight=this.$overlay.lastElementChild)}this._scanRegion=this._calculateScanRegion(ee),requestAnimationFrame(()=>{let ae=window.getComputedStyle(ee);ae.display==="none"&&(ee.style.setProperty("display","block","important"),se=!0),ae.visibility!=="visible"&&(ee.style.setProperty("visibility","visible","important"),se=!0),se&&(console.warn("QrScanner has overwritten the video hiding style to avoid Safari stopping the playback."),ee.style.opacity="0",ee.style.width="0",ee.style.height="0",this.$overlay&&this.$overlay.parentElement&&this.$overlay.parentElement.removeChild(this.$overlay),delete this.$overlay,delete this.$codeOutlineHighlight),this.$overlay&&this._updateOverlay()}),ee.addEventListener("play",this._onPlay),ee.addEventListener("loadedmetadata",this._onLoadedMetaData),document.addEventListener("visibilitychange",this._onVisibilityChange),window.addEventListener("resize",this._updateOverlay),this._qrEnginePromise=e.createQrEngine()}static set WORKER_PATH(ee){console.warn("Setting QrScanner.WORKER_PATH is not required and not supported anymore. Have a look at the README for new setup instructions.")}static async hasCamera(){try{return!!(await e.listCameras(!1)).length}catch{return!1}}static async listCameras(ee=!1){if(!navigator.mediaDevices)return[];let te=async()=>(await navigator.mediaDevices.enumerateDevices()).filter(ie=>ie.kind==="videoinput"),re;try{ee&&(await te()).every(ie=>!ie.label)&&(re=await navigator.mediaDevices.getUserMedia({audio:!1,video:!0}))}catch{}try{return(await te()).map((ie,oe)=>({id:ie.deviceId,label:ie.label||(oe===0?"Default Camera":`Camera ${oe+1}`)}))}finally{re&&(console.warn("Call listCameras after successfully starting a QR scanner to avoid creating a temporary video stream"),e._stopVideoStream(re))}}async hasFlash(){let ee;try{if(this.$video.srcObject){if(!(this.$video.srcObject instanceof MediaStream))return!1;ee=this.$video.srcObject}else ee=(await this._getCameraStream()).stream;return"torch"in ee.getVideoTracks()[0].getSettings()}catch{return!1}finally{ee&&ee!==this.$video.srcObject&&(console.warn("Call hasFlash after successfully starting the scanner to avoid creating a temporary video stream"),e._stopVideoStream(ee))}}isFlashOn(){return this._flashOn}async toggleFlash(){this._flashOn?await this.turnFlashOff():await this.turnFlashOn()}async turnFlashOn(){if(!this._flashOn&&!this._destroyed&&(this._flashOn=!0,this._active&&!this._paused))try{if(!await this.hasFlash())throw"No flash available";await this.$video.srcObject.getVideoTracks()[0].applyConstraints({advanced:[{torch:!0}]})}catch(ee){throw this._flashOn=!1,ee}}async turnFlashOff(){this._flashOn&&(this._flashOn=!1,await this._restartVideoStream())}destroy(){this.$video.removeEventListener("loadedmetadata",this._onLoadedMetaData),this.$video.removeEventListener("play",this._onPlay),document.removeEventListener("visibilitychange",this._onVisibilityChange),window.removeEventListener("resize",this._updateOverlay),this._destroyed=!0,this._flashOn=!1,this.stop(),e._postWorkerMessage(this._qrEnginePromise,"close")}async start(){if(this._destroyed)throw Error("The QR scanner can not be started as it had been destroyed.");if((!this._active||this._paused)&&(window.location.protocol!=="https:"&&console.warn("The camera stream is only accessible if the page is transferred via https."),this._active=!0,!document.hidden))if(this._paused=!1,this.$video.srcObject)await this.$video.play();else try{let{stream:ee,facingMode:te}=await this._getCameraStream();!this._active||this._paused?e._stopVideoStream(ee):(this._setVideoMirror(te),this.$video.srcObject=ee,await this.$video.play(),this._flashOn&&(this._flashOn=!1,this.turnFlashOn().catch(()=>{})))}catch(ee){if(!this._paused)throw this._active=!1,ee}}stop(){this.pause(),this._active=!1}async pause(ee=!1){if(this._paused=!0,!this._active)return!0;this.$video.pause(),this.$overlay&&(this.$overlay.style.display="none");let te=()=>{this.$video.srcObject instanceof MediaStream&&(e._stopVideoStream(this.$video.srcObject),this.$video.srcObject=null)};return ee?(te(),!0):(await new Promise(re=>setTimeout(re,300)),this._paused?(te(),!0):!1)}async setCamera(ee){ee!==this._preferredCamera&&(this._preferredCamera=ee,await this._restartVideoStream())}static async scanImage(ee,te,re,ie,oe=!1,se=!1){let ae,ce=!1;te&&("scanRegion"in te||"qrEngine"in te||"canvas"in te||"disallowCanvasResizing"in te||"alsoTryWithoutScanRegion"in te||"returnDetailedScanResult"in te)?(ae=te.scanRegion,re=te.qrEngine,ie=te.canvas,oe=te.disallowCanvasResizing||!1,se=te.alsoTryWithoutScanRegion||!1,ce=!0):console.warn(te||re||ie||oe||se?"You're using a deprecated api for scanImage which will be removed in the future.":"Note that the return type of scanImage will change in the future. To already switch to the new api today, you can pass returnDetailedScanResult: true."),te=!!re;try{let ue,fe;[re,ue]=await Promise.all([re||e.createQrEngine(),e._loadImage(ee)]),[ie,fe]=e._drawToCanvas(ue,ae,ie,oe);let he;if(re instanceof Worker){let le=re;te||e._postWorkerMessageSync(le,"inversionMode","both"),he=await new Promise((de,pe)=>{let me,ge,we,ve=-1;ge=ye=>{ye.data.id===ve&&(le.removeEventListener("message",ge),le.removeEventListener("error",we),clearTimeout(me),ye.data.data!==null?de({data:ye.data.data,cornerPoints:e._convertPoints(ye.data.cornerPoints,ae)}):pe(e.NO_QR_CODE_FOUND))},we=ye=>{le.removeEventListener("message",ge),le.removeEventListener("error",we),clearTimeout(me),pe("Scanner error: "+(ye?ye.message||ye:"Unknown Error"))},le.addEventListener("message",ge),le.addEventListener("error",we),me=setTimeout(()=>we("timeout"),1e4);let _e=fe.getImageData(0,0,ie.width,ie.height);ve=e._postWorkerMessageSync(le,"decode",_e,[_e.data.buffer])})}else he=await Promise.race([new Promise((le,de)=>window.setTimeout(()=>de("Scanner error: timeout"),1e4)),(async()=>{try{var[le]=await re.detect(ie);if(!le)throw e.NO_QR_CODE_FOUND;return{data:le.rawValue,cornerPoints:e._convertPoints(le.cornerPoints,ae)}}catch(de){if(le=de.message||de,/not implemented|service unavailable/.test(le))return e._disableBarcodeDetector=!0,e.scanImage(ee,{scanRegion:ae,canvas:ie,disallowCanvasResizing:oe,alsoTryWithoutScanRegion:se});throw`Scanner error: ${le}`}})()]);return ce?he:he.data}catch(ue){if(!ae||!se)throw ue;let fe=await e.scanImage(ee,{qrEngine:re,canvas:ie,disallowCanvasResizing:oe});return ce?fe:fe.data}finally{te||e._postWorkerMessage(re,"close")}}setGrayscaleWeights(ee,te,re,ie=!0){e._postWorkerMessage(this._qrEnginePromise,"grayscaleWeights",{red:ee,green:te,blue:re,useIntegerApproximation:ie})}setInversionMode(ee){e._postWorkerMessage(this._qrEnginePromise,"inversionMode",ee)}static async createQrEngine(ee){if(ee&&console.warn("Specifying a worker path is not required and not supported anymore."),ee=()=>__vitePreload(()=>import("./qr-scanner-worker.min.f2f51811.js"),[]).then(re=>re.createWorker()),!(!e._disableBarcodeDetector&&"BarcodeDetector"in window&&BarcodeDetector.getSupportedFormats&&(await BarcodeDetector.getSupportedFormats()).includes("qr_code")))return ee();let te=navigator.userAgentData;return te&&te.brands.some(({brand:re})=>/Chromium/i.test(re))&&/mac ?OS/i.test(te.platform)&&await te.getHighEntropyValues(["architecture","platformVersion"]).then(({architecture:re,platformVersion:ie})=>/arm/i.test(re||"arm")&&13<=parseInt(ie||"13")).catch(()=>!0)?ee():new BarcodeDetector({formats:["qr_code"]})}_onPlay(){this._scanRegion=this._calculateScanRegion(this.$video),this._updateOverlay(),this.$overlay&&(this.$overlay.style.display=""),this._scanFrame()}_onLoadedMetaData(){this._scanRegion=this._calculateScanRegion(this.$video),this._updateOverlay()}_onVisibilityChange(){document.hidden?this.pause():this._active&&this.start()}_calculateScanRegion(ee){let te=Math.round(.6666666666666666*Math.min(ee.videoWidth,ee.videoHeight));return{x:Math.round((ee.videoWidth-te)/2),y:Math.round((ee.videoHeight-te)/2),width:te,height:te,downScaledWidth:this._legacyCanvasSize,downScaledHeight:this._legacyCanvasSize}}_updateOverlay(){requestAnimationFrame(()=>{if(this.$overlay){var ee=this.$video,te=ee.videoWidth,re=ee.videoHeight,ie=ee.offsetWidth,oe=ee.offsetHeight,se=ee.offsetLeft,ae=ee.offsetTop,ce=window.getComputedStyle(ee),ue=ce.objectFit,fe=te/re,he=ie/oe;switch(ue){case"none":var le=te,de=re;break;case"fill":le=ie,de=oe;break;default:(ue==="cover"?fe>he:fe<he)?(de=oe,le=de*fe):(le=ie,de=le/fe),ue==="scale-down"&&(le=Math.min(le,te),de=Math.min(de,re))}var[pe,me]=ce.objectPosition.split(" ").map((we,ve)=>{const _e=parseFloat(we);return we.endsWith("%")?(ve?oe-de:ie-le)*_e/100:_e});ce=this._scanRegion.width||te,he=this._scanRegion.height||re,ue=this._scanRegion.x||0;var ge=this._scanRegion.y||0;fe=this.$overlay.style,fe.width=`${ce/te*le}px`,fe.height=`${he/re*de}px`,fe.top=`${ae+me+ge/re*de}px`,re=/scaleX\(-1\)/.test(ee.style.transform),fe.left=`${se+(re?ie-pe-le:pe)+(re?te-ue-ce:ue)/te*le}px`,fe.transform=ee.style.transform}})}static _convertPoints(ee,te){if(!te)return ee;let re=te.x||0,ie=te.y||0,oe=te.width&&te.downScaledWidth?te.width/te.downScaledWidth:1;te=te.height&&te.downScaledHeight?te.height/te.downScaledHeight:1;for(let se of ee)se.x=se.x*oe+re,se.y=se.y*te+ie;return ee}_scanFrame(){!this._active||this.$video.paused||this.$video.ended||("requestVideoFrameCallback"in this.$video?this.$video.requestVideoFrameCallback.bind(this.$video):requestAnimationFrame)(async()=>{if(!(1>=this.$video.readyState)){var ee=Date.now()-this._lastScanTimestamp,te=1e3/this._maxScansPerSecond;ee<te&&await new Promise(ie=>setTimeout(ie,te-ee)),this._lastScanTimestamp=Date.now();try{var re=await e.scanImage(this.$video,{scanRegion:this._scanRegion,qrEngine:this._qrEnginePromise,canvas:this.$canvas})}catch(ie){if(!this._active)return;this._onDecodeError(ie)}!e._disableBarcodeDetector||await this._qrEnginePromise instanceof Worker||(this._qrEnginePromise=e.createQrEngine()),re?(this._onDecode?this._onDecode(re):this._legacyOnDecode&&this._legacyOnDecode(re.data),this.$codeOutlineHighlight&&(clearTimeout(this._codeOutlineHighlightRemovalTimeout),this._codeOutlineHighlightRemovalTimeout=void 0,this.$codeOutlineHighlight.setAttribute("viewBox",`${this._scanRegion.x||0} ${this._scanRegion.y||0} ${this._scanRegion.width||this.$video.videoWidth} ${this._scanRegion.height||this.$video.videoHeight}`),this.$codeOutlineHighlight.firstElementChild.setAttribute("points",re.cornerPoints.map(({x:ie,y:oe})=>`${ie},${oe}`).join(" ")),this.$codeOutlineHighlight.style.display="")):this.$codeOutlineHighlight&&!this._codeOutlineHighlightRemovalTimeout&&(this._codeOutlineHighlightRemovalTimeout=setTimeout(()=>this.$codeOutlineHighlight.style.display="none",100))}this._scanFrame()})}_onDecodeError(ee){ee!==e.NO_QR_CODE_FOUND&&console.log(ee)}async _getCameraStream(){if(!navigator.mediaDevices)throw"Camera not found.";let ee=/^(environment|user)$/.test(this._preferredCamera)?"facingMode":"deviceId",te=[{width:{min:1024}},{width:{min:768}},{}],re=te.map(ie=>Object.assign({},ie,{[ee]:{exact:this._preferredCamera}}));for(let ie of[...re,...te])try{let oe=await navigator.mediaDevices.getUserMedia({video:ie,audio:!1}),se=this._getFacingMode(oe)||(ie.facingMode?this._preferredCamera:this._preferredCamera==="environment"?"user":"environment");return{stream:oe,facingMode:se}}catch{}throw"Camera not found."}async _restartVideoStream(){let ee=this._paused;await this.pause(!0)&&!ee&&this._active&&await this.start()}static _stopVideoStream(ee){for(let te of ee.getTracks())te.stop(),ee.removeTrack(te)}_setVideoMirror(ee){this.$video.style.transform="scaleX("+(ee==="user"?-1:1)+")"}_getFacingMode(ee){return(ee=ee.getVideoTracks()[0])?/rear|back|environment/i.test(ee.label)?"environment":/front|user|face/i.test(ee.label)?"user":null:null}static _drawToCanvas(ee,te,re,ie=!1){re=re||document.createElement("canvas");let oe=te&&te.x?te.x:0,se=te&&te.y?te.y:0,ae=te&&te.width?te.width:ee.videoWidth||ee.width,ce=te&&te.height?te.height:ee.videoHeight||ee.height;return ie||(ie=te&&te.downScaledWidth?te.downScaledWidth:ae,te=te&&te.downScaledHeight?te.downScaledHeight:ce,re.width!==ie&&(re.width=ie),re.height!==te&&(re.height=te)),te=re.getContext("2d",{alpha:!1}),te.imageSmoothingEnabled=!1,te.drawImage(ee,oe,se,ae,ce,0,0,re.width,re.height),[re,te]}static async _loadImage(ee){if(ee instanceof Image)return await e._awaitImageLoad(ee),ee;if(ee instanceof HTMLVideoElement||ee instanceof HTMLCanvasElement||ee instanceof SVGImageElement||"OffscreenCanvas"in window&&ee instanceof OffscreenCanvas||"ImageBitmap"in window&&ee instanceof ImageBitmap)return ee;if(ee instanceof File||ee instanceof Blob||ee instanceof URL||typeof ee=="string"){let te=new Image;te.src=ee instanceof File||ee instanceof Blob?URL.createObjectURL(ee):ee.toString();try{return await e._awaitImageLoad(te),te}finally{(ee instanceof File||ee instanceof Blob)&&URL.revokeObjectURL(te.src)}}else throw"Unsupported image type."}static async _awaitImageLoad(ee){ee.complete&&ee.naturalWidth!==0||await new Promise((te,re)=>{let ie=oe=>{ee.removeEventListener("load",ie),ee.removeEventListener("error",ie),oe instanceof ErrorEvent?re("Image load error"):te()};ee.addEventListener("load",ie),ee.addEventListener("error",ie)})}static async _postWorkerMessage(ee,te,re,ie){return e._postWorkerMessageSync(await ee,te,re,ie)}static _postWorkerMessageSync(ee,te,re,ie){if(!(ee instanceof Worker))return-1;let oe=e._workerMessageId++;return ee.postMessage({id:oe,type:te,data:re},ie),oe}}e.DEFAULT_CANVAS_SIZE=400;e.NO_QR_CODE_FOUND="No QR code found";e._disableBarcodeDetector=!1;e._workerMessageId=0;const QRScanModal_svelte_svelte_type_style_lang="";function create_fragment$1(ne){let ee,te,re,ie,oe,se,ae,ce,ue,fe,he,le,de;return{c(){ee=element("section"),te=element("div"),re=space(),ie=element("div"),ie.innerHTML='<figure><video id="qr-scan-el" class="svelte-z1h4o0"></video></figure>',oe=space(),se=element("p"),ae=text(ne[0]),ce=space(),ue=element("button"),ue.textContent="Cancel",fe=space(),he=element("div"),attr(te,"class","placeholder svelte-z1h4o0"),attr(ie,"class","video-container svelte-z1h4o0"),attr(se,"class","svelte-z1h4o0"),attr(ue,"class","svelte-z1h4o0"),attr(ee,"class","svelte-z1h4o0"),attr(he,"class","overlay svelte-z1h4o0")},m(pe,me){insert(pe,ee,me),append(ee,te),append(ee,re),append(ee,ie),append(ee,oe),append(ee,se),append(se,ae),append(ee,ce),append(ee,ue),insert(pe,fe,me),insert(pe,he,me),le||(de=listen(ue,"click",ne[3]),le=!0)},p(pe,[me]){me&1&&set_data(ae,pe[0])},i:noop,o:noop,d(pe){pe&&detach(ee),pe&&detach(fe),pe&&detach(he),le=!1,de()}}}function instance$1(ne,ee,te){let re,ie;component_subscribe(ne,modalShown,he=>te(1,re=he)),component_subscribe(ne,storage,he=>te(6,ie=he));let{PIN:oe}=ee,se,ae=Date.now(),ce="Scanning...";setInterval(()=>{Date.now()-ae>2e3&&te(0,ce="Scanning...")},1e3);function ue(he){if(he.data==="")return;let le;try{le=new URL(he.data)}catch{te(0,ce="Invalid QR code (no URL found)"),ae=Date.now();return}if(le.protocol!=="otpauth:"){te(0,ce="Invalid QR code (not an OTP URL)"),ae=Date.now();return}let de,pe;try{[de,pe]=le.pathname.split("/").filter(_e=>_e!=="")}catch{te(0,ce="Invalid QR code (not a valid URL)"),ae=Date.now();return}if(de!=="totp"){te(0,ce="Invalid QR code (not a TOTP URL)"),ae=Date.now();return}let me,ge;try{[me,ge]=pe.split(":")}catch{te(0,ce="Invalid QR code (not a valid URL)"),ae=Date.now();return}const we=le.searchParams.get("secret");if(we===null){te(0,ce="Invalid QR code (no secret found)"),ae=Date.now();return}se.stop();let ve=`${me}: ${ge}`;if(ve=prompt("Enter a name for this account",ve),ve===null){set_store_value(modalShown,re=ModalShown.None,re);return}ie.addAccount(oe,`${me}: ${ge}`,we).then(_e=>{_e===StorageStatus.Duplicate?alert("Account already exists"):_e!==StorageStatus.Success&&alert("Failed to add account from QR code"),window.location.reload()}),set_store_value(modalShown,re=ModalShown.None,re)}onMount(()=>{console.log("onMount");const he=document.getElementById("qr-scan-el");se=new e(he,ue,{returnDetailedScanResult:!0,overlay:!0}),se.start()});const fe=()=>set_store_value(modalShown,re=ModalShown.None,re);return ne.$$set=he=>{"PIN"in he&&te(2,oe=he.PIN)},[ce,re,oe,fe]}class QRScanModal extends SvelteComponent{constructor(ee){super(),init$1(this,ee,instance$1,create_fragment$1,safe_not_equal,{PIN:2})}}function create_if_block(ne){let ee,te;return ee=new QRScanModal({props:{PIN}}),{c(){create_component(ee.$$.fragment)},m(re,ie){mount_component(ee,re,ie),te=!0},p:noop,i(re){te||(transition_in(ee.$$.fragment,re),te=!0)},o(re){transition_out(ee.$$.fragment,re),te=!1},d(re){destroy_component(ee,re)}}}function create_fragment(ne){let ee,te,re,ie,oe,se,ae,ce,ue;te=new Titlebar({props:{PIN}});function fe(de){ne[2](de)}let he={};ne[0]!==void 0&&(he.set=ne[0]),ie=new Totpdisplay({props:he}),binding_callbacks.push(()=>bind(ie,"set",fe)),ae=new Container({props:{PIN,setTOTPDisplay:ne[0]}});let le=ne[1]===ModalShown.QRScan&&create_if_block();return{c(){ee=element("main"),create_component(te.$$.fragment),re=space(),create_component(ie.$$.fragment),se=space(),create_component(ae.$$.fragment),ce=space(),le&&le.c()},m(de,pe){insert(de,ee,pe),mount_component(te,ee,null),append(ee,re),mount_component(ie,ee,null),append(ee,se),mount_component(ae,ee,null),append(ee,ce),le&&le.m(ee,null),ue=!0},p(de,[pe]){const me={};!oe&&pe&1&&(oe=!0,me.set=de[0],add_flush_callback(()=>oe=!1)),ie.$set(me);const ge={};pe&1&&(ge.setTOTPDisplay=de[0]),ae.$set(ge),de[1]===ModalShown.QRScan?le?(le.p(de,pe),pe&2&&transition_in(le,1)):(le=create_if_block(),le.c(),transition_in(le,1),le.m(ee,null)):le&&(group_outros(),transition_out(le,1,1,()=>{le=null}),check_outros())},i(de){ue||(transition_in(te.$$.fragment,de),transition_in(ie.$$.fragment,de),transition_in(ae.$$.fragment,de),transition_in(le),ue=!0)},o(de){transition_out(te.$$.fragment,de),transition_out(ie.$$.fragment,de),transition_out(ae.$$.fragment,de),transition_out(le),ue=!1},d(de){de&&detach(ee),destroy_component(te),destroy_component(ie),destroy_component(ae),le&&le.d()}}}const PIN="blob";function instance(ne,ee,te){let re,ie;component_subscribe(ne,storage,ae=>te(3,re=ae)),component_subscribe(ne,modalShown,ae=>te(1,ie=ae));let oe;re.verifyLocalData()||re.initLocalData(PIN);function se(ae){oe=ae,te(0,oe)}return[oe,ie,se]}class App extends SvelteComponent{constructor(ee){super(),init$1(this,ee,instance,create_fragment,safe_not_equal,{})}}new App({target:document.getElementById("app")});
